import{u as O}from"./disk.dc8bac64.js";import{_ as F,c as G,b as ie,j as oe}from"./main.f5ac513d.js";import{v as A}from"./vue-i18n.c6de3223.js";import{r as C,a as b,m as T,f as N,O as f,j as y,M as h,P as _,l as a,U as n,X as V,R as E,Q as R,by as Y,w as ae,k as L,as as U,aX as te,i as re,g as se,u as H,F as le}from"./@vue.8cc12e6e.js";import{c as g,r as D,d as z,u as ne}from"./@vuelidate.c7422de1.js";import"./axios.7b768d2b.js";import"./pinia.32c02ade.js";import"./v-tooltip.1cd7a91e.js";import"./vue-resize.0b8cd4b5.js";import"./@popperjs.940d197a.js";import"./vue-router.746ec05f.js";import"./lodash.8ab3583e.js";import"./@intlify.0be1c2d8.js";import"./vue.a6ed3e81.js";import"./moment.9709ab41.js";import"./guid.7b3dea7e.js";import"./@headlessui.4523e0e1.js";import"./@vueuse.b6c5a1c1.js";import"./prettier.6e0a0647.js";import"./vue-flatpickr-component.30399bbe.js";import"./flatpickr.dff0933c.js";import"./@heroicons.aa650707.js";import"./v-money3.6f830de1.js";import"./maska.1121c2e3.js";const de={props:{isEdit:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},disks:{type:Array,require:!0,default:Array}},emits:["submit","onChangeDisk"],setup(r,{emit:i}){const t=O(),e=G(),{t:d}=A.useI18n();let k=C(!1),s=C(!1),l=C(null),u=C(null);const c=b({get:()=>t.selected_driver,set:v=>{t.selected_driver=v,t.dropBoxDiskConfig.selected_driver=v}}),m=b(()=>({dropBoxDiskConfig:{root:{required:g.withMessage(d("validation.required"),D)},key:{required:g.withMessage(d("validation.required"),D)},secret:{required:g.withMessage(d("validation.required"),D)},token:{required:g.withMessage(d("validation.required"),D)},app:{required:g.withMessage(d("validation.required"),D)},selected_driver:{required:g.withMessage(d("validation.required"),D)},name:{required:g.withMessage(d("validation.required"),D)}}})),o=z(m,b(()=>t));T(()=>{t.dropBoxDiskConfig={name:null,selected_driver:"dropbox",token:null,key:null,secret:null,app:null}}),B();async function B(){s.value=!0;let v=N({disk:"dropbox"});if(r.isEdit)Object.assign(t.dropBoxDiskConfig,e.data),k.value=e.data.set_as_default,k.value&&(l.value=!0);else{let S=await t.fetchDiskEnv(v);Object.assign(t.dropBoxDiskConfig,S.data)}u.value=r.disks.find(S=>S.value=="dropbox"),s.value=!1}const M=b(()=>!!(r.isEdit&&k.value&&l.value));async function I(){if(o.value.dropBoxDiskConfig.$touch(),o.value.dropBoxDiskConfig.$invalid)return!0;let v={credentials:t.dropBoxDiskConfig,name:t.dropBoxDiskConfig.name,driver:u.value.value,set_as_default:k.value};return i("submit",v),!1}function w(){i("onChangeDisk",t.dropBoxDiskConfig.selected_driver)}return{v$:o,diskStore:t,selected_driver:c,set_as_default:k,isLoading:s,is_current_disk:l,selected_disk:u,isDisabled:M,loadData:B,submitData:I,onChangeDriver:w}}},ue={class:"px-8 py-6"},fe={key:0,class:"flex items-center mt-6"},ke={class:"relative flex items-center w-12"},me={class:"ml-4 right"},ve={class:"p-0 mb-1 text-base leading-snug text-black box-title"};function ge(r,i,t,e,d,k){const s=f("BaseInput"),l=f("BaseInputGroup"),u=f("BaseMultiselect"),c=f("BaseInputGrid"),m=f("BaseSwitch");return y(),h("form",{onSubmit:i[15]||(i[15]=Y((...o)=>e.submitData&&e.submitData(...o),["prevent"]))},[_("div",ue,[a(c,null,{default:n(()=>[a(l,{label:r.$t("settings.disk.name"),error:e.v$.dropBoxDiskConfig.name.$error&&e.v$.dropBoxDiskConfig.name.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.dropBoxDiskConfig.name,"onUpdate:modelValue":i[0]||(i[0]=o=>e.diskStore.dropBoxDiskConfig.name=o),type:"text",name:"name",invalid:e.v$.dropBoxDiskConfig.name.$error,onInput:i[1]||(i[1]=o=>e.v$.dropBoxDiskConfig.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.driver"),error:e.v$.dropBoxDiskConfig.selected_driver.$error&&e.v$.dropBoxDiskConfig.selected_driver.$errors[0].$message,required:""},{default:n(()=>[a(u,{modelValue:e.selected_driver,"onUpdate:modelValue":[i[2]||(i[2]=o=>e.selected_driver=o),i[3]||(i[3]=o=>e.onChangeDriver(r.data))],invalid:e.v$.dropBoxDiskConfig.selected_driver.$error,"value-prop":"value",options:t.disks,searchable:"",label:"name","can-deselect":!1},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.dropbox_root"),error:e.v$.dropBoxDiskConfig.root.$error&&e.v$.dropBoxDiskConfig.root.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.dropBoxDiskConfig.root,"onUpdate:modelValue":i[4]||(i[4]=o=>e.diskStore.dropBoxDiskConfig.root=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. /user/root/",invalid:e.v$.dropBoxDiskConfig.root.$error,onInput:i[5]||(i[5]=o=>e.v$.dropBoxDiskConfig.root.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.dropbox_token"),error:e.v$.dropBoxDiskConfig.token.$error&&e.v$.dropBoxDiskConfig.token.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.dropBoxDiskConfig.token,"onUpdate:modelValue":i[6]||(i[6]=o=>e.diskStore.dropBoxDiskConfig.token=o),modelModifiers:{trim:!0},type:"text",name:"name",invalid:e.v$.dropBoxDiskConfig.token.$error,onInput:i[7]||(i[7]=o=>e.v$.dropBoxDiskConfig.token.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.dropbox_key"),error:e.v$.dropBoxDiskConfig.key.$error&&e.v$.dropBoxDiskConfig.key.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.dropBoxDiskConfig.key,"onUpdate:modelValue":i[8]||(i[8]=o=>e.diskStore.dropBoxDiskConfig.key=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. KEIS4S39SERSDS",invalid:e.v$.dropBoxDiskConfig.key.$error,onInput:i[9]||(i[9]=o=>e.v$.dropBoxDiskConfig.key.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.dropbox_secret"),error:e.v$.dropBoxDiskConfig.secret.$error&&e.v$.dropBoxDiskConfig.secret.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.dropBoxDiskConfig.secret,"onUpdate:modelValue":i[10]||(i[10]=o=>e.diskStore.dropBoxDiskConfig.secret=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. ********",invalid:e.v$.dropBoxDiskConfig.secret.$error,onInput:i[11]||(i[11]=o=>e.v$.dropBoxDiskConfig.secret.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.dropbox_app"),error:e.v$.dropBoxDiskConfig.app.$error&&e.v$.dropBoxDiskConfig.app.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.dropBoxDiskConfig.app,"onUpdate:modelValue":i[12]||(i[12]=o=>e.diskStore.dropBoxDiskConfig.app=o),modelModifiers:{trim:!0},type:"text",name:"name",invalid:e.v$.dropBoxDiskConfig.app.$error,onInput:i[13]||(i[13]=o=>e.v$.dropBoxDiskConfig.app.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1}),e.isDisabled?E("",!0):(y(),h("div",fe,[_("div",ke,[a(m,{modelValue:e.set_as_default,"onUpdate:modelValue":i[14]||(i[14]=o=>e.set_as_default=o),class:"flex"},null,8,["modelValue"])]),_("div",me,[_("p",ve,V(r.$t("settings.disk.is_default")),1)])]))]),R(r.$slots,"default",{diskData:{isLoading:e.isLoading,submitData:e.submitData}})],32)}var ce=F(de,[["render",ge]]);const De={props:{isEdit:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},disks:{type:Array,require:!0,default:Array}},emits:["submit","onChangeDisk"],setup(r,{emit:i}){const t=O(),e=G(),{t:d}=A.useI18n();let k=C(!1),s=C(!1),l=C(""),u=C(null);const c=b({get:()=>t.selected_driver,set:v=>{t.selected_driver=v,t.localDiskConfig.selected_driver=v}}),m=b(()=>({localDiskConfig:{name:{required:g.withMessage(d("validation.required"),D)},selected_driver:{required:g.withMessage(d("validation.required"),D)},root:{required:g.withMessage(d("validation.required"),D)}}})),o=z(m,b(()=>t));T(()=>{t.localDiskConfig={name:null,selected_driver:"local",root:null}}),B();async function B(){k.value=!0;let v=N({disk:"local"});if(r.isEdit)Object.assign(t.localDiskConfig,e.data),t.localDiskConfig.root=e.data.credentials,s.value=e.data.set_as_default,s.value&&(u.value=!0);else{let S=await t.fetchDiskEnv(v);Object.assign(t.localDiskConfig,S.data)}l.value=r.disks.find(S=>S.value=="local"),k.value=!1}const M=b(()=>!!(r.isEdit&&s.value&&u.value));async function I(){if(o.value.localDiskConfig.$touch(),o.value.localDiskConfig.$invalid)return!0;let v=N({credentials:t.localDiskConfig.root,name:t.localDiskConfig.name,driver:t.localDiskConfig.selected_driver,set_as_default:s.value});return i("submit",v),!1}function w(){i("onChangeDisk",t.localDiskConfig.selected_driver)}return{v$:o,diskStore:t,modalStore:e,selected_driver:c,selected_disk:l,isLoading:k,set_as_default:s,is_current_disk:u,submitData:I,onChangeDriver:w,isDisabled:M}}},pe={class:"px-4 sm:px-8 py-6"},Ce={key:0,class:"flex items-center mt-6"},_e={class:"relative flex items-center w-12"},be={class:"ml-4 right"},Se={class:"p-0 mb-1 text-base leading-snug text-black box-title"};function $e(r,i,t,e,d,k){const s=f("BaseInput"),l=f("BaseInputGroup"),u=f("BaseMultiselect"),c=f("BaseInputGrid"),m=f("BaseSwitch");return y(),h("form",{action:"",onSubmit:i[7]||(i[7]=Y((...o)=>e.submitData&&e.submitData(...o),["prevent"]))},[_("div",pe,[a(c,null,{default:n(()=>[a(l,{label:r.$t("settings.disk.name"),error:e.v$.localDiskConfig.name.$error&&e.v$.localDiskConfig.name.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.localDiskConfig.name,"onUpdate:modelValue":i[0]||(i[0]=o=>e.diskStore.localDiskConfig.name=o),type:"text",name:"name",invalid:e.v$.localDiskConfig.name.$error,onInput:i[1]||(i[1]=o=>e.v$.localDiskConfig.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$tc("settings.disk.driver"),error:e.v$.localDiskConfig.selected_driver.$error&&e.v$.localDiskConfig.selected_driver.$errors[0].$message,required:""},{default:n(()=>[a(u,{modelValue:e.selected_driver,"onUpdate:modelValue":[i[2]||(i[2]=o=>e.selected_driver=o),i[3]||(i[3]=o=>e.onChangeDriver(r.data))],"value-prop":"value",invalid:e.v$.localDiskConfig.selected_driver.$error,options:t.disks,searchable:"",label:"name","can-deselect":!1},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.local_root"),error:e.v$.localDiskConfig.root.$error&&e.v$.localDiskConfig.root.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.localDiskConfig.root,"onUpdate:modelValue":i[4]||(i[4]=o=>e.diskStore.localDiskConfig.root=o),modelModifiers:{trim:!0},type:"text",name:"name",invalid:e.v$.localDiskConfig.root.$error,placeholder:"Ex./user/root/",onInput:i[5]||(i[5]=o=>e.v$.localDiskConfig.root.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1}),e.isDisabled?E("",!0):(y(),h("div",Ce,[_("div",_e,[a(m,{modelValue:e.set_as_default,"onUpdate:modelValue":i[6]||(i[6]=o=>e.set_as_default=o),class:"flex"},null,8,["modelValue"])]),_("div",be,[_("p",Se,V(r.$t("settings.disk.is_default")),1)])]))]),R(r.$slots,"default",{diskData:{isLoading:e.isLoading,submitData:e.submitData}})],32)}var ye=F(De,[["render",$e]]);const Be={props:{isEdit:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},disks:{type:Array,require:!0,default:Array}},emits:["submit","onChangeDisk"],setup(r,{emit:i}){const t=O(),e=G(),{t:d}=A.useI18n();let k=C(!1),s=C(!1),l=C(null),u=C(null);const c=b({get:()=>t.selected_driver,set:v=>{t.selected_driver=v,t.s3DiskConfigData.selected_driver=v}}),m=b(()=>({s3DiskConfigData:{name:{required:g.withMessage(d("validation.required"),D)},root:{required:g.withMessage(d("validation.required"),D)},key:{required:g.withMessage(d("validation.required"),D)},secret:{required:g.withMessage(d("validation.required"),D)},region:{required:g.withMessage(d("validation.required"),D)},bucket:{required:g.withMessage(d("validation.required"),D)},selected_driver:{required:g.withMessage(d("validation.required"),D)}}})),o=z(m,b(()=>t));T(()=>{t.s3DiskConfigData={name:null,selected_driver:"s3",key:null,secret:null,region:null,bucket:null,root:null}}),B();async function B(){s.value=!0;let v=N({disk:"s3"});if(r.isEdit)Object.assign(t.s3DiskConfigData,e.data),k.value=e.data.set_as_default,k.value&&(u.value=!0);else{let S=await t.fetchDiskEnv(v);Object.assign(t.s3DiskConfigData,S.data)}l.value=r.disks.find(S=>S.value=="s3"),s.value=!1}const M=b(()=>!!(r.isEdit&&k.value&&u.value));async function I(){if(o.value.s3DiskConfigData.$touch(),o.value.s3DiskConfigData.$invalid)return!0;let v={credentials:t.s3DiskConfigData,name:t.s3DiskConfigData.name,driver:l.value.value,set_as_default:k.value};return i("submit",v),!1}function w(){i("onChangeDisk",t.s3DiskConfigData.selected_driver)}return{v$:o,diskStore:t,modalStore:e,set_as_default:k,isLoading:s,selected_disk:l,selected_driver:c,is_current_disk:u,loadData:B,submitData:I,onChangeDriver:w,isDisabled:M}}},xe={class:"px-8 py-6"},Ve={key:0,class:"flex items-center mt-6"},qe={class:"relative flex items-center w-12"},Me={class:"ml-4 right"},Ie={class:"p-0 mb-1 text-base leading-snug text-black box-title"};function we(r,i,t,e,d,k){const s=f("BaseInput"),l=f("BaseInputGroup"),u=f("BaseMultiselect"),c=f("BaseInputGrid"),m=f("BaseSwitch");return y(),h("form",{onSubmit:i[15]||(i[15]=Y((...o)=>e.submitData&&e.submitData(...o),["prevent"]))},[_("div",xe,[a(c,null,{default:n(()=>[a(l,{label:r.$t("settings.disk.name"),error:e.v$.s3DiskConfigData.name.$error&&e.v$.s3DiskConfigData.name.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.s3DiskConfigData.name,"onUpdate:modelValue":i[0]||(i[0]=o=>e.diskStore.s3DiskConfigData.name=o),type:"text",name:"name",invalid:e.v$.s3DiskConfigData.name.$error,onInput:i[1]||(i[1]=o=>e.v$.s3DiskConfigData.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$tc("settings.disk.driver"),error:e.v$.s3DiskConfigData.selected_driver.$error&&e.v$.s3DiskConfigData.selected_driver.$errors[0].$message,required:""},{default:n(()=>[a(u,{modelValue:e.selected_driver,"onUpdate:modelValue":[i[2]||(i[2]=o=>e.selected_driver=o),i[3]||(i[3]=o=>e.onChangeDriver(r.data))],invalid:e.v$.s3DiskConfigData.selected_driver.$error,"value-prop":"value",options:t.disks,searchable:"",label:"name","can-deselect":!1},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.aws_root"),error:e.v$.s3DiskConfigData.root.$error&&e.v$.s3DiskConfigData.root.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.s3DiskConfigData.root,"onUpdate:modelValue":i[4]||(i[4]=o=>e.diskStore.s3DiskConfigData.root=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. /user/root/",invalid:e.v$.s3DiskConfigData.root.$error,onInput:i[5]||(i[5]=o=>e.v$.s3DiskConfigData.root.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.aws_key"),error:e.v$.s3DiskConfigData.key.$error&&e.v$.s3DiskConfigData.key.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.s3DiskConfigData.key,"onUpdate:modelValue":i[6]||(i[6]=o=>e.diskStore.s3DiskConfigData.key=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. KEIS4S39SERSDS",invalid:e.v$.s3DiskConfigData.key.$error,onInput:i[7]||(i[7]=o=>e.v$.s3DiskConfigData.key.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.aws_secret"),error:e.v$.s3DiskConfigData.secret.$error&&e.v$.s3DiskConfigData.secret.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.s3DiskConfigData.secret,"onUpdate:modelValue":i[8]||(i[8]=o=>e.diskStore.s3DiskConfigData.secret=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. ********",invalid:e.v$.s3DiskConfigData.secret.$error,onInput:i[9]||(i[9]=o=>e.v$.s3DiskConfigData.secret.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.aws_region"),error:e.v$.s3DiskConfigData.region.$error&&e.v$.s3DiskConfigData.region.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.s3DiskConfigData.region,"onUpdate:modelValue":i[10]||(i[10]=o=>e.diskStore.s3DiskConfigData.region=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. us-west",invalid:e.v$.s3DiskConfigData.region.$error,onInput:i[11]||(i[11]=o=>e.v$.s3DiskConfigData.region.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.aws_bucket"),error:e.v$.s3DiskConfigData.bucket.$error&&e.v$.s3DiskConfigData.bucket.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.s3DiskConfigData.bucket,"onUpdate:modelValue":i[12]||(i[12]=o=>e.diskStore.s3DiskConfigData.bucket=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. AppName",invalid:e.v$.s3DiskConfigData.bucket.$error,onInput:i[13]||(i[13]=o=>e.v$.s3DiskConfigData.bucket.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1}),e.isDisabled?E("",!0):(y(),h("div",Ve,[_("div",qe,[a(m,{modelValue:e.set_as_default,"onUpdate:modelValue":i[14]||(i[14]=o=>e.set_as_default=o),class:"flex"},null,8,["modelValue"])]),_("div",Me,[_("p",Ie,V(r.$t("settings.disk.is_default")),1)])]))]),R(r.$slots,"default",{diskData:{isLoading:e.isLoading,submitData:e.submitData}})],32)}var Ee=F(Be,[["render",we]]);const he={props:{isEdit:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},disks:{type:Array,require:!0,default:Array}},emits:["submit","onChangeDisk"],setup(r,{emit:i}){const t=O(),e=G(),{t:d}=A.useI18n();let k=C(!1),s=C(!1),l=C(""),u=C(null);const c=b({get:()=>t.selected_driver,set:v=>{t.selected_driver=v,t.doSpaceDiskConfig.selected_driver=v}}),m=b(()=>({doSpaceDiskConfig:{root:{required:g.withMessage(d("validation.required"),D)},key:{required:g.withMessage(d("validation.required"),D)},secret:{required:g.withMessage(d("validation.required"),D)},region:{required:g.withMessage(d("validation.required"),D)},endpoint:{required:g.withMessage(d("validation.required"),D),url:g.withMessage(d("validation.invalid_url"),ne)},bucket:{required:g.withMessage(d("validation.required"),D)},selected_driver:{required:g.withMessage(d("validation.required"),D)},name:{required:g.withMessage(d("validation.required"),D)}}})),o=z(m,b(()=>t));T(()=>{t.doSpaceDiskConfig={name:null,selected_driver:"doSpaces",key:null,secret:null,region:null,bucket:null,endpoint:null,root:null}}),B();async function B(){k.value=!0;let v=N({disk:"doSpaces"});if(r.isEdit)Object.assign(t.doSpaceDiskConfig,JSON.parse(e.data.credentials)),s.value=e.data.set_as_default,s.value&&(u.value=!0);else{let S=await t.fetchDiskEnv(v);Object.assign(t.doSpaceDiskConfig,S.data)}l.value=r.disks.find(S=>S.value=="doSpaces"),k.value=!1}const M=b(()=>!!(r.isEdit&&s.value&&u.value));async function I(){if(o.value.doSpaceDiskConfig.$touch(),o.value.doSpaceDiskConfig.$invalid)return!0;let v={credentials:t.doSpaceDiskConfig,name:t.doSpaceDiskConfig.name,driver:l.value.value,set_as_default:s.value};return i("submit",v),!1}function w(){i("onChangeDisk",t.doSpaceDiskConfig.selected_driver)}return{v$:o,diskStore:t,selected_driver:c,isLoading:k,set_as_default:s,selected_disk:l,is_current_disk:u,loadData:B,submitData:I,onChangeDriver:w,isDisabled:M}}},Ue={class:"px-8 py-6"},Le={key:0,class:"flex items-center mt-6"},Ne={class:"relative flex items-center w-12"},Oe={class:"ml-4 right"},Ge={class:"p-0 mb-1 text-base leading-snug text-black box-title"};function je(r,i,t,e,d,k){const s=f("BaseInput"),l=f("BaseInputGroup"),u=f("BaseMultiselect"),c=f("BaseInputGrid"),m=f("BaseSwitch");return y(),h("form",{onSubmit:i[17]||(i[17]=Y((...o)=>e.submitData&&e.submitData(...o),["prevent"]))},[_("div",Ue,[a(c,null,{default:n(()=>[a(l,{label:r.$t("settings.disk.name"),error:e.v$.doSpaceDiskConfig.name.$error&&e.v$.doSpaceDiskConfig.name.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.doSpaceDiskConfig.name,"onUpdate:modelValue":i[0]||(i[0]=o=>e.diskStore.doSpaceDiskConfig.name=o),type:"text",name:"name",invalid:e.v$.doSpaceDiskConfig.name.$error,onInput:i[1]||(i[1]=o=>e.v$.doSpaceDiskConfig.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$tc("settings.disk.driver"),error:e.v$.doSpaceDiskConfig.selected_driver.$error&&e.v$.doSpaceDiskConfig.selected_driver.$errors[0].$message,required:""},{default:n(()=>[a(u,{modelValue:e.selected_driver,"onUpdate:modelValue":[i[2]||(i[2]=o=>e.selected_driver=o),i[3]||(i[3]=o=>e.onChangeDriver(r.data))],invalid:e.v$.doSpaceDiskConfig.selected_driver.$error,"value-prop":"value",options:t.disks,searchable:"",label:"name","can-deselect":!1,"track-by":"name"},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.do_spaces_root"),error:e.v$.doSpaceDiskConfig.root.$error&&e.v$.doSpaceDiskConfig.root.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.doSpaceDiskConfig.root,"onUpdate:modelValue":i[4]||(i[4]=o=>e.diskStore.doSpaceDiskConfig.root=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. /user/root/",invalid:e.v$.doSpaceDiskConfig.root.$error,onInput:i[5]||(i[5]=o=>e.v$.doSpaceDiskConfig.root.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.do_spaces_key"),error:e.v$.doSpaceDiskConfig.key.$error&&e.v$.doSpaceDiskConfig.key.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.doSpaceDiskConfig.key,"onUpdate:modelValue":i[6]||(i[6]=o=>e.diskStore.doSpaceDiskConfig.key=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. KEIS4S39SERSDS",invalid:e.v$.doSpaceDiskConfig.key.$error,onInput:i[7]||(i[7]=o=>e.v$.doSpaceDiskConfig.key.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.do_spaces_secret"),error:e.v$.doSpaceDiskConfig.secret.$error&&e.v$.doSpaceDiskConfig.secret.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.doSpaceDiskConfig.secret,"onUpdate:modelValue":i[8]||(i[8]=o=>e.diskStore.doSpaceDiskConfig.secret=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. ********",invalid:e.v$.doSpaceDiskConfig.secret.$error,onInput:i[9]||(i[9]=o=>e.v$.doSpaceDiskConfig.secret.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.do_spaces_region"),error:e.v$.doSpaceDiskConfig.region.$error&&e.v$.doSpaceDiskConfig.region.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.doSpaceDiskConfig.region,"onUpdate:modelValue":i[10]||(i[10]=o=>e.diskStore.doSpaceDiskConfig.region=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. nyc3",invalid:e.v$.doSpaceDiskConfig.region.$error,onInput:i[11]||(i[11]=o=>e.v$.doSpaceDiskConfig.region.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.do_spaces_endpoint"),error:e.v$.doSpaceDiskConfig.endpoint.$error&&e.v$.doSpaceDiskConfig.endpoint.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.doSpaceDiskConfig.endpoint,"onUpdate:modelValue":i[12]||(i[12]=o=>e.diskStore.doSpaceDiskConfig.endpoint=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. https://nyc3.digitaloceanspaces.com",invalid:e.v$.doSpaceDiskConfig.endpoint.$error,onInput:i[13]||(i[13]=o=>e.v$.doSpaceDiskConfig.endpoint.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(l,{label:r.$t("settings.disk.do_spaces_bucket"),error:e.v$.doSpaceDiskConfig.bucket.$error&&e.v$.doSpaceDiskConfig.bucket.$errors[0].$message,required:""},{default:n(()=>[a(s,{modelValue:e.diskStore.doSpaceDiskConfig.bucket,"onUpdate:modelValue":i[14]||(i[14]=o=>e.diskStore.doSpaceDiskConfig.bucket=o),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. my-new-space",invalid:e.v$.doSpaceDiskConfig.bucket.$error,onInput:i[15]||(i[15]=o=>e.v$.doSpaceDiskConfig.bucket.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1}),e.isDisabled?E("",!0):(y(),h("div",Le,[_("div",Ne,[a(m,{modelValue:e.set_as_default,"onUpdate:modelValue":i[16]||(i[16]=o=>e.set_as_default=o),class:"flex"},null,8,["modelValue"])]),_("div",Oe,[_("p",Ge,V(r.$t("settings.disk.is_default")),1)])]))]),R(r.$slots,"default",{diskData:{isLoading:e.isLoading,submitData:e.submitData}})],32)}var Fe=F(he,[["render",je]]);const Ae={components:{Dropbox:ce,Local:ye,S3:Ee,DoSpaces:Fe},setup(){const r=O(),i=G();let t=C(!1),e=C(!1);ae(()=>{i.id&&(e.value=!0)});const d=b(()=>i.active&&i.componentName==="FileDiskModal");function k(m){return m&&(m.diskData.isLoading.value||t.value)}async function s(){t.value=!0;let m=await r.fetchDiskDrivers();e.value?r.selected_driver=i.data.driver:r.selected_driver=m.data.drivers[0].value,t.value=!1}async function l(m){Object.assign(r.diskConfigData,m),t.value=!0;let o={id:i.id,...m};await(e.value?r.updateDisk:r.createDisk)(o),t.value=!1,i.refreshData(),u()}function u(){i.closeModal()}function c(m){r.selected_driver=m,r.diskConfigData.selected_driver=m}return{isEdit:e,createNewDisk:l,isRequestFire:k,diskStore:r,closeDiskModal:u,loadData:s,diskChange:c,modalStore:i,isLoading:t,modalActive:d}}},Te={class:"flex justify-between w-full"},Re={class:"file-disk-modal"},Ye={class:"z-0 flex justify-end p-4 border-t border-solid border-gray-light"};function ze(r,i,t,e,d,k){const s=f("BaseIcon"),l=f("BaseButton"),u=f("BaseModal");return y(),L(u,{show:e.modalActive,onClose:e.closeDiskModal,onOpen:e.loadData},{header:n(()=>[_("div",Te,[U(V(e.modalStore.title)+" ",1),a(s,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:e.closeDiskModal},null,8,["onClick"])])]),default:n(()=>[_("div",Re,[(y(),L(te(e.diskStore.selected_driver),{loading:e.isLoading,disks:e.diskStore.getDiskDrivers,"is-edit":e.isEdit,onOnChangeDisk:i[0]||(i[0]=c=>e.diskChange(c)),onSubmit:e.createNewDisk},{default:n(c=>[_("div",Ye,[a(l,{class:"mr-3 text-sm",variant:"primary-outline",type:"button",onClick:e.closeDiskModal},{default:n(()=>[U(V(r.$t("general.cancel")),1)]),_:1},8,["onClick"]),a(l,{loading:e.isRequestFire(c),disabled:e.isRequestFire(c),variant:"primary",type:"submit"},{default:n(()=>[e.isRequestFire(c)?E("",!0):(y(),L(s,{key:0,name:"SaveIcon",class:"w-6 mr-2"})),U(" "+V(r.$t("general.save")),1)]),_:2},1032,["loading","disabled"])])]),_:1},40,["loading","disks","is-edit","onSubmit"]))])]),_:1},8,["show","onClose","onOpen"])}var Pe=F(Ae,[["render",ze]]);const Ke={class:"inline-block"},pi={__name:"FileDiskSetting",setup(r){const i=re("utils"),t=G(),e=O(),d=ie(),k=oe(),{t:s}=A.useI18n();let l=C(!1),u=C("");const c=b(()=>[{key:"name",label:s("settings.disk.disk_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"driver",label:s("settings.disk.filesystem_driver"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"type",label:s("settings.disk.disk_type"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"set_as_default",label:s("settings.disk.is_default"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),m=C(d.selectedCompanySettings.save_pdf_to_disk),o=b({get:()=>m.value==="YES",set:async p=>{const q=p?"YES":"NO";let x={settings:{save_pdf_to_disk:q}};m.value=q,await d.updateCompanySettings({data:x,message:"general.setting_updated"})}});async function B({page:p,filter:q,sort:x}){let P=N({orderByField:x.fieldName||"created_at",orderBy:x.order||"desc",page:p}),j=await e.fetchDisks(P);return{data:j.data.data,pagination:{totalPages:j.data.meta.last_page,currentPage:p,totalCount:j.data.meta.total}}}function M(p){return p.set_as_default?!(p.type=="SYSTEM"&&p.set_as_default):!0}function I(){t.openModal({title:s("settings.disk.new_disk"),componentName:"FileDiskModal",variant:"lg",refreshData:u.value&&u.value.refresh})}function w(p){t.openModal({title:s("settings.disk.edit_file_disk"),componentName:"FileDiskModal",variant:"lg",id:p.id,data:p,refreshData:u.value&&u.value.refresh})}function v(p){k.openDialog({title:s("general.are_you_sure"),message:s("settings.disk.set_default_disk_confirm"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(async q=>{if(q){l.value=!0;let x=N({set_as_default:!0,id:p});await e.updateDisk(x).then(()=>{u.value&&u.value.refresh()})}})}function S(p){k.openDialog({title:s("general.are_you_sure"),message:s("settings.disk.confirm_delete"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async q=>{if(q&&(await e.deleteFileDisk(p)).data.success)return u.value&&u.value.refresh(),!0})}return(p,q)=>{const x=f("BaseIcon"),P=f("BaseButton"),j=f("BaseBadge"),K=f("BaseDropdownItem"),J=f("BaseDropdown"),Q=f("BaseTable"),W=f("BaseDivider"),Z=f("BaseSwitchSection"),ee=f("BaseSettingCard");return y(),h(le,null,[a(Pe),a(ee,{title:p.$tc("settings.disk.title",1),description:p.$t("settings.disk.description")},{action:n(()=>[a(P,{variant:"primary-outline",onClick:I},{left:n($=>[a(x,{class:se($.class),name:"PlusIcon"},null,8,["class"])]),default:n(()=>[U(" "+V(p.$t("settings.disk.new_disk")),1)]),_:1})]),default:n(()=>[a(Q,{ref_key:"table",ref:u,class:"mt-16",data:B,columns:c.value},{"cell-set_as_default":n(({row:$})=>[a(j,{"bg-color":H(i).getBadgeStatusColor($.data.set_as_default?"YES":"NO").bgColor,color:H(i).getBadgeStatusColor($.data.set_as_default?"YES":"NO").color},{default:n(()=>[U(V($.data.set_as_default?"Yes":"No".replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),"cell-actions":n(({row:$})=>[M($.data)?(y(),L(J,{key:0},{activator:n(()=>[_("div",Ke,[a(x,{name:"DotsHorizontalIcon",class:"text-gray-500"})])]),default:n(()=>[$.data.set_as_default?E("",!0):(y(),L(K,{key:0,onClick:X=>v($.data.id)},{default:n(()=>[a(x,{class:"mr-3 tetx-gray-600",name:"CheckCircleIcon"}),U(" "+V(p.$t("settings.disk.set_default_disk")),1)]),_:2},1032,["onClick"])),$.data.type!=="SYSTEM"?(y(),L(K,{key:1,onClick:X=>w($.data)},{default:n(()=>[a(x,{name:"PencilIcon",class:"mr-3 text-gray-600"}),U(" "+V(p.$t("general.edit")),1)]),_:2},1032,["onClick"])):E("",!0),$.data.type!=="SYSTEM"&&!$.data.set_as_default?(y(),L(K,{key:2,onClick:X=>S($.data.id)},{default:n(()=>[a(x,{name:"TrashIcon",class:"mr-3 text-gray-600"}),U(" "+V(p.$t("general.delete")),1)]),_:2},1032,["onClick"])):E("",!0)]),_:2},1024)):E("",!0)]),_:1},8,["columns"]),a(W,{class:"mt-8 mb-2"}),a(Z,{modelValue:o.value,"onUpdate:modelValue":q[0]||(q[0]=$=>o.value=$),title:p.$t("settings.disk.save_pdf_to_disk"),description:p.$t("settings.disk.disk_setting_description")},null,8,["modelValue","title","description"])]),_:1},8,["title","description"])],64)}}};export{pi as default};
