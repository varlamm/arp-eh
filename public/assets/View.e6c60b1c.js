import{v as A}from"./vue-i18n.c6de3223.js";import{u as H,w,x as W}from"./main.f5ac513d.js";import{l as X}from"./lodash.8ab3583e.js";import{u as J}from"./vue-router.746ec05f.js";import"./moment.9709ab41.js";import{u as K}from"./payment.35969c87.js";import{u as Q}from"./global.b17b6368.js";import{f as P,r as V,i as Y,a as b,e as Z,O as i,j as c,k as h,U as r,l as a,u as s,g as j,as as ee,X as y,P as n,M as F,aW as te,F as ae,R as U}from"./@vue.8cc12e6e.js";import"./@intlify.0be1c2d8.js";import"./vue.a6ed3e81.js";import"./v-tooltip.1cd7a91e.js";import"./vue-resize.0b8cd4b5.js";import"./@popperjs.940d197a.js";import"./axios.7b768d2b.js";import"./pinia.32c02ade.js";import"./@vuelidate.c7422de1.js";import"./guid.7b3dea7e.js";import"./@headlessui.4523e0e1.js";import"./@vueuse.b6c5a1c1.js";import"./prettier.6e0a0647.js";import"./vue-flatpickr-component.30399bbe.js";import"./flatpickr.dff0933c.js";import"./@heroicons.aa650707.js";import"./v-money3.6f830de1.js";import"./maska.1121c2e3.js";import"./auth.f67c9755.js";const oe={class:"fixed top-0 left-0 hidden h-full pt-16 pb-4 bg-white w-88 xl:block"},re={class:"flex items-center justify-between px-4 pt-8 pb-6 border border-gray-200 border-solid"},se={class:"flex ml-3",role:"group","aria-label":"First group"},ne={class:"px-4 py-1 pb-2 mb-2 text-sm border-b border-gray-200 border-solid"},le={class:"px-2"},ie={class:"px-2"},de={class:"px-2"},me={class:"h-full pb-32 overflow-y-scroll border-l border-gray-200 border-solid sw-scroll"},ce={class:"flex-2"},ue={class:"mb-1 text-md not-italic font-medium leading-5 text-gray-500 capitalize"},pe={class:"flex-1 whitespace-nowrap right"},ye={class:"text-sm text-right text-gray-500 non-italic"},fe={key:0,class:"flex justify-center px-4 mt-5 text-sm text-gray-600"},_e={class:"flex flex-col min-h-0 mt-8 overflow-hidden",style:{height:"75vh"}},be=["src"],He={__name:"View",setup(he){const u=J(),m=K(),f=Q(),{tm:k,t:ge}=A.useI18n();let _=P({}),e=P({orderBy:"",orderByField:"",payment_number:""}),g=V(!1),z=V(!1);V(!1),Y("utils"),H();const C=b(()=>m.selectedViewPayment),I=b(()=>e.orderBy==="asc"||e.orderBy==null);b(()=>I.value?k("general.ascending"):k("general.descending"));const S=b(()=>_.unique_hash?`/payments/pdf/${_.unique_hash}`:!1);Z(u,()=>{$()}),N(),$(),d=X.exports.debounce(d,500);function D(t){return u.params.id==t}async function N(){await m.fetchPayments({limit:"all"},f.companySlug),setTimeout(()=>{R()},500)}async function $(){if(u&&u.params.id){let t=await m.fetchViewPayment({id:u.params.id},f.companySlug);t.data&&Object.assign(_,t.data.data)}}function R(){const t=document.getElementById(`payment-${u.params.id}`);t&&(t.scrollIntoView({behavior:"smooth"}),t.classList.add("shake"))}async function d(){let t={};e.payment_number!==""&&e.payment_number!==null&&e.payment_number!==void 0&&(t.payment_number=e.payment_number),e.orderBy!==null&&e.orderBy!==void 0&&(t.orderBy=e.orderBy),e.orderByField!==null&&e.orderByField!==void 0&&(t.orderByField=e.orderByField),g.value=!0;try{let l=await m.searchPayment(t,f.companySlug);g.value=!1,l.data.data&&(m.payments=l.data.data)}catch{g.value=!1}}function T(){return e.orderBy==="asc"?(e.orderBy="desc",d(),!0):(e.orderBy="asc",d(),!0)}return(t,l)=>{const p=i("BaseIcon"),v=i("BaseButton"),q=i("BasePageHeader"),E=i("BaseInput"),B=i("BaseRadio"),x=i("BaseInputGroup"),G=i("BaseFormatMoney"),L=i("router-link"),M=i("BasePage");return c(),h(M,{class:"xl:pl-96"},{default:r(()=>[a(q,{title:C.value.payment_number},{actions:r(()=>[a(v,{disabled:s(z),variant:"primary-outline",tag:"a",download:"",href:`/payments/pdf/${s(_).unique_hash}`},{left:r(o=>[a(p,{name:"DownloadIcon",class:j(o.class)},null,8,["class"]),ee(" "+y(t.$t("general.download")),1)]),_:1},8,["disabled","href"])]),_:1},8,["title"]),n("div",oe,[n("div",re,[a(E,{modelValue:s(e).payment_number,"onUpdate:modelValue":l[0]||(l[0]=o=>s(e).payment_number=o),placeholder:t.$t("general.search"),type:"text",variant:"gray",onInput:d},{right:r(()=>[a(p,{name:"SearchIcon",class:"h-5 text-gray-400"})]),_:1},8,["modelValue","placeholder"]),n("div",se,[a(W,{position:"bottom-start","width-class":"w-50","position-class":"left-0"},{activator:r(()=>[a(v,{variant:"gray"},{default:r(()=>[a(p,{name:"FilterIcon",class:"h-5"})]),_:1})]),default:r(()=>[n("div",ne,y(t.$t("general.sort_by")),1),n("div",le,[a(w,{class:"rounded-md pt-3 hover:rounded-md"},{default:r(()=>[a(x,{class:"-mt-3 font-normal"},{default:r(()=>[a(B,{id:"filter_invoice_number",modelValue:s(e).orderByField,"onUpdate:modelValue":[l[1]||(l[1]=o=>s(e).orderByField=o),d],label:t.$t("invoices.title"),size:"sm",name:"filter",value:"invoice_number"},null,8,["modelValue","label"])]),_:1})]),_:1})]),n("div",ie,[a(w,{class:"rounded-md pt-3 hover:rounded-md"},{default:r(()=>[a(x,{class:"-mt-3 font-normal"},{default:r(()=>[a(B,{id:"filter_payment_date",modelValue:s(e).orderByField,"onUpdate:modelValue":[l[2]||(l[2]=o=>s(e).orderByField=o),d],label:t.$t("payments.date"),size:"sm",name:"filter",value:"payment_date"},null,8,["modelValue","label"])]),_:1})]),_:1})]),n("div",de,[a(w,{class:"rounded-md pt-3 hover:rounded-md"},{default:r(()=>[a(x,{class:"-mt-3 font-normal"},{default:r(()=>[a(B,{id:"filter_payment_number",modelValue:s(e).orderByField,"onUpdate:modelValue":[l[3]||(l[3]=o=>s(e).orderByField=o),d],label:t.$t("payments.payment_number"),size:"sm",name:"filter",value:"payment_number"},null,8,["modelValue","label"])]),_:1})]),_:1})])]),_:1}),a(v,{class:"ml-1",variant:"white",onClick:T},{default:r(()=>[I.value?(c(),h(p,{key:0,name:"SortAscendingIcon",class:"h-5"})):(c(),h(p,{key:1,name:"SortDescendingIcon",class:"h-5"}))]),_:1})])]),n("div",me,[(c(!0),F(ae,null,te(s(m).payments,(o,O)=>(c(),h(L,{id:"payment-"+o.id,key:O,to:`/${s(f).companySlug}/customer/payments/${o.id}/view`,class:j(["flex justify-between p-4 items-center cursor-pointer hover:bg-gray-100 border-l-4 border-transparent",{"bg-gray-100 border-l-4 border-primary-500 border-solid":D(o.id)}]),style:{"border-bottom":"1px solid rgba(185, 193, 209, 0.41)"}},{default:r(()=>[n("div",ce,[n("div",ue,y(o.payment_number),1)]),n("div",pe,[a(G,{class:"mb-2 text-xl not-italic font-semibold leading-8 text-right text-gray-900 block",amount:o.amount,currency:o.currency},null,8,["amount","currency"]),n("div",ye,y(o.formatted_payment_date),1)])]),_:2},1032,["id","to","class"]))),128)),s(m).payments.length?U("",!0):(c(),F("p",fe,y(t.$t("payments.no_matching_payments")),1))])]),n("div",_e,[S.value?(c(),F("iframe",{key:0,src:S.value,class:"flex-1 border border-gray-400 border-solid rounded-md"},null,8,be)):U("",!0)])]),_:1})}}};export{He as default};
