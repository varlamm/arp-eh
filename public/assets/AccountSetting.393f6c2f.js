import{r as $,a as b,f as N,O as u,j as B,M as R,l as r,U as l,u as t,z as D,k as h,g as j,R as z,as as L,X as P,by as E,P as O}from"./@vue.8cc12e6e.js";import{e as T,d as X,b as H}from"./main.f5ac513d.js";import{v as J}from"./vue-i18n.c6de3223.js";import{d as K,c as f,r as V,e as Q,m as W,s as Y}from"./@vuelidate.c7422de1.js";import"./v-tooltip.1cd7a91e.js";import"./vue-resize.0b8cd4b5.js";import"./@popperjs.940d197a.js";import"./axios.7b768d2b.js";import"./vue-router.746ec05f.js";import"./pinia.32c02ade.js";import"./lodash.8ab3583e.js";import"./@intlify.0be1c2d8.js";import"./vue.a6ed3e81.js";import"./moment.9709ab41.js";import"./guid.7b3dea7e.js";import"./@headlessui.4523e0e1.js";import"./@vueuse.b6c5a1c1.js";import"./prettier.6e0a0647.js";import"./vue-flatpickr-component.30399bbe.js";import"./flatpickr.dff0933c.js";import"./@heroicons.aa650707.js";import"./v-money3.6f830de1.js";import"./maska.1121c2e3.js";const Z=["onSubmit"],x=O("span",null,null,-1),Se={__name:"AccountSetting",setup(ee){const i=T(),U=X(),S=H(),{t:c}=J.useI18n();let m=$(!1),d=$(null),g=$([]);const w=$(!1);i.currentUser.avatar&&g.value.push({image:i.currentUser.avatar});const I=b(()=>({name:{required:f.withMessage(c("validation.required"),V)},email:{required:f.withMessage(c("validation.required"),V),email:f.withMessage(c("validation.email_incorrect"),Q)},password:{minLength:f.withMessage(c("validation.password_length",{count:8}),W(8))},confirm_password:{sameAsPassword:f.withMessage(c("validation.password_incorrect"),Y(a.password))}})),a=N({name:i.currentUser.name,email:i.currentUser.email,language:i.currentUserSettings.language||S.selectedCompanySettings.language,password:"",confirm_password:""}),o=K(I,b(()=>a));function y(n,e){d.value=e}function C(){d.value=null,w.value=!0}async function M(){if(o.value.$touch(),o.value.$invalid)return!0;m.value=!0;let n={name:a.name,email:a.email};try{if(a.password!=null&&a.password!==void 0&&a.password!==""&&(n={...n,password:a.password}),i.currentUserSettings.language!==a.language&&await i.updateUserSettings({settings:{language:a.language}}),(await i.updateCurrentUser(n)).data.data){if(m.value=!1,d.value||w.value){let v=new FormData;d.value&&v.append("admin_avatar",d.value),v.append("is_admin_avatar_removed",w.value),await i.uploadAvatar(v),d.value=null,w.value=!1}a.password="",a.confirm_password=""}}catch{return m.value=!1,!0}}return(n,e)=>{const v=u("BaseFileUploader"),p=u("BaseInputGroup"),_=u("BaseInput"),F=u("BaseMultiselect"),q=u("BaseInputGrid"),k=u("BaseIcon"),A=u("BaseButton"),G=u("BaseSettingCard");return B(),R("form",{class:"relative",onSubmit:E(M,["prevent"])},[r(G,{title:n.$t("settings.account_settings.account_settings"),description:n.$t("settings.account_settings.section_description")},{default:l(()=>[r(q,null,{default:l(()=>[r(p,{label:n.$tc("settings.account_settings.profile_picture")},{default:l(()=>[r(v,{modelValue:t(g),"onUpdate:modelValue":e[0]||(e[0]=s=>D(g)?g.value=s:g=s),avatar:!0,accept:"image/*",onChange:y,onRemove:C},null,8,["modelValue"])]),_:1},8,["label"]),x,r(p,{label:n.$tc("settings.account_settings.name"),error:t(o).name.$error&&t(o).name.$errors[0].$message,required:""},{default:l(()=>[r(_,{modelValue:a.name,"onUpdate:modelValue":e[1]||(e[1]=s=>a.name=s),invalid:t(o).name.$error,onInput:e[2]||(e[2]=s=>t(o).name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),r(p,{label:n.$tc("settings.account_settings.email"),error:t(o).email.$error&&t(o).email.$errors[0].$message,required:""},{default:l(()=>[r(_,{modelValue:a.email,"onUpdate:modelValue":e[3]||(e[3]=s=>a.email=s),invalid:t(o).email.$error,onInput:e[4]||(e[4]=s=>t(o).email.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),r(p,{error:t(o).password.$error&&t(o).password.$errors[0].$message,label:n.$tc("settings.account_settings.password")},{default:l(()=>[r(_,{modelValue:a.password,"onUpdate:modelValue":e[5]||(e[5]=s=>a.password=s),type:"password",onInput:e[6]||(e[6]=s=>t(o).password.$touch())},null,8,["modelValue"])]),_:1},8,["error","label"]),r(p,{label:n.$tc("settings.account_settings.confirm_password"),error:t(o).confirm_password.$error&&t(o).confirm_password.$errors[0].$message},{default:l(()=>[r(_,{modelValue:a.confirm_password,"onUpdate:modelValue":e[7]||(e[7]=s=>a.confirm_password=s),type:"password",onInput:e[8]||(e[8]=s=>t(o).confirm_password.$touch())},null,8,["modelValue"])]),_:1},8,["label","error"]),r(p,{label:n.$tc("settings.language")},{default:l(()=>[r(F,{modelValue:a.language,"onUpdate:modelValue":e[9]||(e[9]=s=>a.language=s),options:t(U).config.languages,label:"name","value-prop":"code","track-by":"name","open-direction":"top"},null,8,["modelValue","options"])]),_:1},8,["label"])]),_:1}),r(A,{loading:t(m),disabled:t(m),class:"mt-6"},{left:l(s=>[t(m)?z("",!0):(B(),h(k,{key:0,name:"SaveIcon",class:j(s.class)},null,8,["class"]))]),default:l(()=>[L(" "+P(n.$tc("settings.company_info.save")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["title","description"])],40,Z)}}};export{Se as default};
