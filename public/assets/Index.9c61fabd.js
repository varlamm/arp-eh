import{r as _,f as O,i as q,a as $,O as o,j as f,k as b,U as t,l as n,L as k,bx as I,u as r,g as F,as as v,X as i,R as A,P as B}from"./@vue.8cc12e6e.js";import J from"./BaseTable.62565885.js";import{_ as K}from"./CapsuleIcon.65ebf9b5.js";import{x as Q,w as Y}from"./main.f5ac513d.js";import{v as Z}from"./vue-i18n.c6de3223.js";import{u as ee}from"./payment.35969c87.js";import{u as te}from"./global.b17b6368.js";import{u as ae}from"./vue-router.746ec05f.js";import{d as ne}from"./@vueuse.b6c5a1c1.js";import"./lodash.8ab3583e.js";import"./@intlify.0be1c2d8.js";import"./moment.9709ab41.js";import"./v-tooltip.1cd7a91e.js";import"./vue-resize.0b8cd4b5.js";import"./@popperjs.940d197a.js";import"./axios.7b768d2b.js";import"./pinia.32c02ade.js";import"./vue.a6ed3e81.js";import"./@vuelidate.c7422de1.js";import"./guid.7b3dea7e.js";import"./@headlessui.4523e0e1.js";import"./prettier.6e0a0647.js";import"./vue-flatpickr-component.30399bbe.js";import"./flatpickr.dff0933c.js";import"./@heroicons.aa650707.js";import"./v-money3.6f830de1.js";import"./maska.1121c2e3.js";import"./auth.f67c9755.js";const oe={class:"relative table-container"},le=["innerHTML"],Te={__name:"Index",setup(me){const{tm:se,t:p}=Z.useI18n();let u=_(!1);_("created_at");let h=_(!0),P=_(null);const l=O({payment_mode:"",payment_number:""}),M=q("utils");ae();const c=ee(),y=te(),C=$(()=>!c.totalPayments&&!h.value),D=$(()=>y.currency),H=$(()=>[{key:"payment_date",label:p("payments.date"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"payment_number",label:p("payments.payment_number")},{key:"payment_mode",label:p("payments.payment_mode")},{key:"invoice_number",label:p("invoices.invoice_number")},{key:"amount",label:p("payments.amount")},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]);ne(l,()=>{j()},{debounce:500});async function N(a){return(await c.fetchPaymentModes(a,y.companySlug)).data.data}async function E({page:a,filter:s,sort:d}){let g={payment_method_id:l.payment_mode!==null?l.payment_mode:"",payment_number:l.payment_number,orderByField:d.fieldName||"created_at",orderBy:d.order||"desc",page:a};h.value=!0;let m=await c.fetchPayments(g,y.companySlug);return h.value=!1,{data:m.data.data,pagination:{totalPages:m.data.meta.last_page,currentPage:a,totalCount:m.data.meta.total,limit:10}}}function T(){P.value.refresh()}function j(){T()}function S(){l.customer="",l.payment_mode="",l.payment_number=""}function x(){u.value&&S(),u.value=!u.value}return(a,s)=>{const d=o("BaseBreadcrumbItem"),g=o("BaseBreadcrumb"),m=o("BaseIcon"),G=o("BaseButton"),L=o("BasePageHeader"),U=o("BaseInput"),V=o("BaseInputGroup"),W=o("BaseMultiselect"),z=o("BaseFilterWrapper"),R=o("BaseEmptyPlaceholder"),w=o("router-link"),X=o("BasePage");return f(),b(X,null,{default:t(()=>[n(L,{title:a.$t("payments.title")},{actions:t(()=>[k(n(G,{variant:"primary-outline",onClick:x},{right:t(e=>[r(u)?(f(),b(m,{key:1,class:F(e.class),name:"XIcon"},null,8,["class"])):(f(),b(m,{key:0,class:F(e.class),name:"FilterIcon"},null,8,["class"]))]),default:t(()=>[v(i(a.$t("general.filter"))+" ",1)]),_:1},512),[[I,r(c).totalPayments]])]),default:t(()=>[n(g,{slot:"breadcrumbs"},{default:t(()=>[n(d,{title:a.$t("general.home"),to:`/${r(y).companySlug}/customer/dashboard`},null,8,["title","to"]),n(d,{title:a.$tc("payments.payment",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),k(n(z,{onClear:S},{default:t(()=>[n(V,{label:a.$t("payments.payment_number"),class:"px-3"},{default:t(()=>[n(U,{modelValue:l.payment_number,"onUpdate:modelValue":s[0]||(s[0]=e=>l.payment_number=e),placeholder:a.$t("payments.payment_number")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),n(V,{label:a.$t("payments.payment_mode"),class:"px-3"},{default:t(()=>[n(W,{modelValue:l.payment_mode,"onUpdate:modelValue":s[1]||(s[1]=e=>l.payment_mode=e),"value-prop":"id","track-by":"name","filter-results":!1,label:"name","resolve-on-load":"",delay:100,searchable:"",options:N,placeholder:a.$t("payments.payment_mode")},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1},512),[[I,r(u)]]),C.value?(f(),b(R,{key:0,title:a.$t("payments.no_payments"),description:a.$t("payments.list_of_payments")},{default:t(()=>[n(K,{class:"mt-5 mb-4"})]),_:1},8,["title","description"])):A("",!0),k(B("div",oe,[n(J,{ref_key:"table",ref:P,data:E,columns:H.value,"placeholder-count":r(c).totalPayments>=20?10:5,class:"mt-10"},{"cell-payment_date":t(({row:e})=>[v(i(e.data.formatted_payment_date),1)]),"cell-payment_number":t(({row:e})=>[n(w,{to:{path:`payments/${e.data.id}/view`},class:"font-medium text-primary-500"},{default:t(()=>[v(i(e.data.payment_number),1)]),_:2},1032,["to"])]),"cell-payment_mode":t(({row:e})=>[B("span",null,i(e.data.payment_method?e.data.payment_method.name:a.$t("payments.not_selected")),1)]),"cell-invoice_number":t(({row:e})=>[B("span",null,i(e.data.invoice?.invoice_number?e.data.invoice?.invoice_number:a.$t("payments.no_invoice")),1)]),"cell-amount":t(({row:e})=>[B("div",{innerHTML:r(M).formatMoney(e.data.amount,D.value)},null,8,le)]),"cell-actions":t(({row:e})=>[n(Q,null,{activator:t(()=>[n(m,{name:"DotsHorizontalIcon",class:"w-5 text-gray-500"})]),default:t(()=>[n(w,{to:`payments/${e.data.id}/view`},{default:t(()=>[n(Y,null,{default:t(()=>[n(m,{name:"EyeIcon",class:"h-5 mr-3 text-gray-600"}),v(" "+i(a.$t("general.view")),1)]),_:1})]),_:2},1032,["to"])]),_:2},1024)]),_:1},8,["columns","placeholder-count"])],512),[[I,!C.value]])]),_:1})}}};export{Te as default};
