import{P,a as B,S as j,T as L,N as J,E as Gt}from"./prosemirror-state.903cf479.js";import{t as Nt}from"./tippy.js.73af9788.js";import{d as z,r as ht,o as mt,m as Z,h as N,q as Jt,w as Zt,n as Yt,u as Qt,T as Xt,s as te,f as ee,v as ne,x as se}from"./@vue.8cc12e6e.js";import{d as re}from"./prosemirror-dropcursor.f1bd8d40.js";import{g as oe}from"./prosemirror-gapcursor.6daa0df5.js";import{u as ie,r as ae,h as ce}from"./prosemirror-history.eb3d6ec3.js";import{E as de}from"./prosemirror-view.c8812119.js";import{k as le}from"./prosemirror-keymap.64e16793.js";import{F as V,S as ue,D as pe,a as fe,b as he}from"./prosemirror-model.2d18793b.js";import{f as me,c as gt,l as ge,j as Rt,a as W,R as ye,b as be}from"./prosemirror-transform.18cbf34a.js";import{c as ve,d as ke,e as Me,j as we,a as Se,b as Te,f as xe,l as Ae,g as Ee,n as Ce,s as Le,h as Oe,i as He,k as Pe,m as $e,o as St,w as Be}from"./prosemirror-commands.009b9b4a.js";import{l as Ie,s as Ne,w as Re}from"./prosemirror-schema-list.cc5c4b30.js";function Y(e){const{state:t,transaction:n}=e;let{selection:s}=n,{doc:r}=n,{storedMarks:i}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return i},get selection(){return s},get doc(){return r},get tr(){return s=n.selection,r=n.doc,i=n.storedMarks,n}}}class Q{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:s}=this,{view:r}=n,{tr:i}=s,o=this.buildProps(i);return Object.fromEntries(Object.entries(t).map(([a,c])=>[a,(...p)=>{const l=c(...p)(o);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&r.dispatch(i),l}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:s,editor:r,state:i}=this,{view:o}=r,a=[],c=!!t,d=t||i.tr,p=()=>(!c&&n&&!d.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(d),a.every(u=>u===!0)),l={...Object.fromEntries(Object.entries(s).map(([u,f])=>[u,(...m)=>{const g=this.buildProps(d,n),b=f(...m)(g);return a.push(b),l}])),run:p};return l}createCan(t){const{rawCommands:n,state:s}=this,r=!1,i=t||s.tr,o=this.buildProps(i,r);return{...Object.fromEntries(Object.entries(n).map(([c,d])=>[c,(...p)=>d(...p)({...o,dispatch:void 0})])),chain:()=>this.createChain(i,r)}}buildProps(t,n=!0){const{rawCommands:s,editor:r,state:i}=this,{view:o}=r,a={tr:t,editor:r,view:o,state:Y({state:i,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t,n),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(s).map(([c,d])=>[c,(...p)=>d(...p)(a)]))}};return a}}class je{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const s=this.callbacks[t];return s&&s.forEach(r=>r.apply(this,n)),this}off(t,n){const s=this.callbacks[t];return s&&(n?this.callbacks[t]=s.filter(r=>r!==n):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}function y(e,t,n){return e.config[t]===void 0&&e.parent?y(e.parent,t,n):typeof e.config[t]=="function"?e.config[t].bind({...n,parent:e.parent?y(e.parent,t,n):null}):e.config[t]}function X(e){const t=e.filter(r=>r.type==="extension"),n=e.filter(r=>r.type==="node"),s=e.filter(r=>r.type==="mark");return{baseExtensions:t,nodeExtensions:n,markExtensions:s}}function jt(e){const t=[],{nodeExtensions:n,markExtensions:s}=X(e),r=[...n,...s],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},c=y(o,"addGlobalAttributes",a);if(!c)return;c().forEach(p=>{p.types.forEach(l=>{Object.entries(p.attributes).forEach(([u,f])=>{t.push({type:l,name:u,attribute:{...i,...f}})})})})}),r.forEach(o=>{const a={name:o.name,options:o.options,storage:o.storage},c=y(o,"addAttributes",a);if(!c)return;const d=c();Object.entries(d).forEach(([p,l])=>{const u={...i,...l};typeof u?.default=="function"&&(u.default=u.default()),u?.isRequired&&u?.default===void 0&&delete u.default,t.push({type:o.name,name:p,attribute:u})})}),t}function T(e,t){if(typeof e=="string"){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function S(...e){return e.filter(t=>!!t).reduce((t,n)=>{const s={...t};return Object.entries(n).forEach(([r,i])=>{if(!s[r]){s[r]=i;return}if(r==="class"){const a=i?i.split(" "):[],c=s[r]?s[r].split(" "):[],d=a.filter(p=>!c.includes(p));s[r]=[...c,...d].join(" ")}else r==="style"?s[r]=[s[r],i].join("; "):s[r]=i}),s},{})}function lt(e,t){return t.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(e.attrs)||{}:{[n.name]:e.attrs[n.name]}).reduce((n,s)=>S(n,s),{})}function _t(e){return typeof e=="function"}function k(e,t=void 0,...n){return _t(e)?t?e.bind(t)(...n):e(...n):e}function _e(e={}){return Object.keys(e).length===0&&e.constructor===Object}function De(e){return typeof e!="string"?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):e==="true"?!0:e==="false"?!1:e}function Tt(e,t){return e.style?e:{...e,getAttrs:n=>{const s=e.getAttrs?e.getAttrs(n):e.attrs;if(s===!1)return!1;const r=t.reduce((i,o)=>{const a=o.attribute.parseHTML?o.attribute.parseHTML(n):De(n.getAttribute(o.name));return a==null?i:{...i,[o.name]:a}},{});return{...s,...r}}}}function xt(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>t==="attrs"&&_e(n)?!1:n!=null))}function Fe(e,t){var n;const s=jt(e),{nodeExtensions:r,markExtensions:i}=X(e),o=(n=r.find(d=>y(d,"topNode")))===null||n===void 0?void 0:n.name,a=Object.fromEntries(r.map(d=>{const p=s.filter(b=>b.type===d.name),l={name:d.name,options:d.options,storage:d.storage,editor:t},u=e.reduce((b,v)=>{const M=y(v,"extendNodeSchema",l);return{...b,...M?M(d):{}}},{}),f=xt({...u,content:k(y(d,"content",l)),marks:k(y(d,"marks",l)),group:k(y(d,"group",l)),inline:k(y(d,"inline",l)),atom:k(y(d,"atom",l)),selectable:k(y(d,"selectable",l)),draggable:k(y(d,"draggable",l)),code:k(y(d,"code",l)),defining:k(y(d,"defining",l)),isolating:k(y(d,"isolating",l)),attrs:Object.fromEntries(p.map(b=>{var v;return[b.name,{default:(v=b?.attribute)===null||v===void 0?void 0:v.default}]}))}),h=k(y(d,"parseHTML",l));h&&(f.parseDOM=h.map(b=>Tt(b,p)));const m=y(d,"renderHTML",l);m&&(f.toDOM=b=>m({node:b,HTMLAttributes:lt(b,p)}));const g=y(d,"renderText",l);return g&&(f.toText=g),[d.name,f]})),c=Object.fromEntries(i.map(d=>{const p=s.filter(g=>g.type===d.name),l={name:d.name,options:d.options,storage:d.storage,editor:t},u=e.reduce((g,b)=>{const v=y(b,"extendMarkSchema",l);return{...g,...v?v(d):{}}},{}),f=xt({...u,inclusive:k(y(d,"inclusive",l)),excludes:k(y(d,"excludes",l)),group:k(y(d,"group",l)),spanning:k(y(d,"spanning",l)),code:k(y(d,"code",l)),attrs:Object.fromEntries(p.map(g=>{var b;return[g.name,{default:(b=g?.attribute)===null||b===void 0?void 0:b.default}]}))}),h=k(y(d,"parseHTML",l));h&&(f.parseDOM=h.map(g=>Tt(g,p)));const m=y(d,"renderHTML",l);return m&&(f.toDOM=g=>m({mark:g,HTMLAttributes:lt(g,p)})),[d.name,f]}));return new he({topNode:o,nodes:a,marks:c})}function ot(e,t){return t.nodes[e]||t.marks[e]||null}function At(e,t){return Array.isArray(t)?t.some(n=>(typeof n=="string"?n:n.name)===e.name):t}const Ke=(e,t=500)=>{let n="";const s=e.parentOffset;return e.parent.nodesBetween(Math.max(0,s-t),s,(r,i,o,a)=>{var c,d;n+=(((d=(c=r.type.spec).toText)===null||d===void 0?void 0:d.call(c,{node:r,pos:i,parent:o,index:a}))||r.textContent||"%leaf%").slice(0,Math.max(0,s-i))}),n};function yt(e){return Object.prototype.toString.call(e)==="[object RegExp]"}class tt{constructor(t){this.find=t.find,this.handler=t.handler}}const ze=(e,t)=>{if(yt(t))return t.exec(e);const n=t(e);if(!n)return null;const s=[n.text];return s.index=n.index,s.input=e,s.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),s.push(n.replaceWith)),s};function it(e){var t;const{editor:n,from:s,to:r,text:i,rules:o,plugin:a}=e,{view:c}=n;if(c.composing)return!1;const d=c.state.doc.resolve(s);if(d.parent.type.spec.code||!!(!((t=d.nodeBefore||d.nodeAfter)===null||t===void 0)&&t.marks.find(u=>u.type.spec.code)))return!1;let p=!1;const l=Ke(d)+i;return o.forEach(u=>{if(p)return;const f=ze(l,u.find);if(!f)return;const h=c.state.tr,m=Y({state:c.state,transaction:h}),g={from:s-(f[0].length-i.length),to:r},{commands:b,chain:v,can:M}=new Q({editor:n,state:m});u.handler({state:m,range:g,match:f,commands:b,chain:v,can:M})===null||!h.steps.length||(h.setMeta(a,{transform:h,from:s,to:r,text:i}),c.dispatch(h),p=!0)}),p}function Ve(e){const{editor:t,rules:n}=e,s=new P({state:{init(){return null},apply(r,i){const o=r.getMeta(s);return o||(r.selectionSet||r.docChanged?null:i)}},props:{handleTextInput(r,i,o,a){return it({editor:t,from:i,to:o,text:a,rules:n,plugin:s})},handleDOMEvents:{compositionend:r=>(setTimeout(()=>{const{$cursor:i}=r.state.selection;i&&it({editor:t,from:i.pos,to:i.pos,text:"",rules:n,plugin:s})}),!1)},handleKeyDown(r,i){if(i.key!=="Enter")return!1;const{$cursor:o}=r.state.selection;return o?it({editor:t,from:o.pos,to:o.pos,text:`
`,rules:n,plugin:s}):!1}},isInputRules:!0});return s}function We(e){return typeof e=="number"}class qe{constructor(t){this.find=t.find,this.handler=t.handler}}const Ue=(e,t)=>{if(yt(t))return[...e.matchAll(t)];const n=t(e);return n?n.map(s=>{const r=[s.text];return r.index=s.index,r.input=e,r.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),r.push(s.replaceWith)),r}):[]};function Ge(e){const{editor:t,state:n,from:s,to:r,rule:i,pasteEvent:o,dropEvent:a}=e,{commands:c,chain:d,can:p}=new Q({editor:t,state:n}),l=[];return n.doc.nodesBetween(s,r,(f,h)=>{if(!f.isTextblock||f.type.spec.code)return;const m=Math.max(s,h),g=Math.min(r,h+f.content.size),b=f.textBetween(m-h,g-h,void 0,"\uFFFC");Ue(b,i.find).forEach(M=>{if(M.index===void 0)return;const x=m+M.index+1,C=x+M[0].length,w={from:n.tr.mapping.map(x),to:n.tr.mapping.map(C)},O=i.handler({state:n,range:w,match:M,commands:c,chain:d,can:p,pasteEvent:o,dropEvent:a});l.push(O)})}),l.every(f=>f!==null)}function Je(e){const{editor:t,rules:n}=e;let s=null,r=!1,i=!1,o=new ClipboardEvent("paste"),a=new DragEvent("drop");return n.map(d=>new P({view(p){const l=u=>{var f;s=!((f=p.dom.parentElement)===null||f===void 0)&&f.contains(u.target)?p.dom.parentElement:null};return window.addEventListener("dragstart",l),{destroy(){window.removeEventListener("dragstart",l)}}},props:{handleDOMEvents:{drop:(p,l)=>(i=s===p.dom.parentElement,a=l,!1),paste:(p,l)=>{var u;const f=(u=l.clipboardData)===null||u===void 0?void 0:u.getData("text/html");return o=l,r=!!f?.includes("data-pm-slice"),!1}}},appendTransaction:(p,l,u)=>{const f=p[0],h=f.getMeta("uiEvent")==="paste"&&!r,m=f.getMeta("uiEvent")==="drop"&&!i;if(!h&&!m)return;const g=l.doc.content.findDiffStart(u.doc.content),b=l.doc.content.findDiffEnd(u.doc.content);if(!We(g)||!b||g===b.b)return;const v=u.tr,M=Y({state:u,transaction:v});if(!(!Ge({editor:t,state:M,from:Math.max(g-1,0),to:b.b-1,rule:d,pasteEvent:o,dropEvent:a})||!v.steps.length))return a=new DragEvent("drop"),o=new ClipboardEvent("paste"),v}}))}function Ze(e){const t=e.filter((n,s)=>e.indexOf(n)!==s);return[...new Set(t)]}class R{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=R.resolve(t),this.schema=Fe(this.extensions,n),this.extensions.forEach(s=>{var r;this.editor.extensionStorage[s.name]=s.storage;const i={name:s.name,options:s.options,storage:s.storage,editor:this.editor,type:ot(s.name,this.schema)};s.type==="mark"&&((r=k(y(s,"keepOnSplit",i)))!==null&&r!==void 0?r:!0)&&this.splittableMarks.push(s.name);const o=y(s,"onBeforeCreate",i);o&&this.editor.on("beforeCreate",o);const a=y(s,"onCreate",i);a&&this.editor.on("create",a);const c=y(s,"onUpdate",i);c&&this.editor.on("update",c);const d=y(s,"onSelectionUpdate",i);d&&this.editor.on("selectionUpdate",d);const p=y(s,"onTransaction",i);p&&this.editor.on("transaction",p);const l=y(s,"onFocus",i);l&&this.editor.on("focus",l);const u=y(s,"onBlur",i);u&&this.editor.on("blur",u);const f=y(s,"onDestroy",i);f&&this.editor.on("destroy",f)})}static resolve(t){const n=R.sort(R.flatten(t)),s=Ze(n.map(r=>r.name));return s.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${s.map(r=>`'${r}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const s={name:n.name,options:n.options,storage:n.storage},r=y(n,"addExtensions",s);return r?[n,...this.flatten(r())]:n}).flat(10)}static sort(t){return t.sort((s,r)=>{const i=y(s,"priority")||100,o=y(r,"priority")||100;return i>o?-1:i<o?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const s={name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:ot(n.name,this.schema)},r=y(n,"addCommands",s);return r?{...t,...r()}:t},{})}get plugins(){const{editor:t}=this,n=R.sort([...this.extensions].reverse()),s=[],r=[],i=n.map(o=>{const a={name:o.name,options:o.options,storage:o.storage,editor:t,type:ot(o.name,this.schema)},c=[],d=y(o,"addKeyboardShortcuts",a);let p={};if(o.type==="mark"&&o.config.exitable&&(p.ArrowRight=()=>H.handleExit({editor:t,mark:o})),d){const m=Object.fromEntries(Object.entries(d()).map(([g,b])=>[g,()=>b({editor:t})]));p={...p,...m}}const l=le(p);c.push(l);const u=y(o,"addInputRules",a);At(o,t.options.enableInputRules)&&u&&s.push(...u());const f=y(o,"addPasteRules",a);At(o,t.options.enablePasteRules)&&f&&r.push(...f());const h=y(o,"addProseMirrorPlugins",a);if(h){const m=h();c.push(...m)}return c}).flat();return[Ve({editor:t,rules:s}),...Je({editor:t,rules:r}),...i]}get attributes(){return jt(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=X(this.extensions);return Object.fromEntries(n.filter(s=>!!y(s,"addNodeView")).map(s=>{const r=this.attributes.filter(c=>c.type===s.name),i={name:s.name,options:s.options,storage:s.storage,editor:t,type:T(s.name,this.schema)},o=y(s,"addNodeView",i);if(!o)return[];const a=(c,d,p,l)=>{const u=lt(c,r);return o()({editor:t,node:c,getPos:p,decorations:l,HTMLAttributes:u,extension:s})};return[s.name,a]}))}}function Ye(e){return Object.prototype.toString.call(e).slice(8,-1)}function at(e){return Ye(e)!=="Object"?!1:e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype}function et(e,t){const n={...e};return at(e)&&at(t)&&Object.keys(t).forEach(s=>{at(t[s])?s in e?n[s]=et(e[s],t[s]):Object.assign(n,{[s]:t[s]}):Object.assign(n,{[s]:t[s]})}),n}class A{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=k(y(this,"addOptions",{name:this.name}))),this.storage=k(y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new A(t)}configure(t={}){const n=this.extend();return n.options=et(this.options,t),n.storage=k(y(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new A(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=k(y(n,"addOptions",{name:n.name})),n.storage=k(y(n,"addStorage",{name:n.name,options:n.options})),n}}function Dt(e,t,n){const{from:s,to:r}=t,{blockSeparator:i=`

`,textSerializers:o={}}=n||{};let a="",c=!0;return e.nodesBetween(s,r,(d,p,l,u)=>{var f;const h=o?.[d.type.name];h?(d.isBlock&&!c&&(a+=i,c=!0),l&&(a+=h({node:d,pos:p,parent:l,index:u,range:t}))):d.isText?(a+=(f=d?.text)===null||f===void 0?void 0:f.slice(Math.max(s,p)-p,r-p),c=!1):d.isBlock&&!c&&(a+=i,c=!0)}),a}function Ft(e){return Object.fromEntries(Object.entries(e.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const Qe=A.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new P({key:new B("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:s,selection:r}=t,{ranges:i}=r,o=Math.min(...i.map(p=>p.$from.pos)),a=Math.max(...i.map(p=>p.$to.pos)),c=Ft(n);return Dt(s,{from:o,to:a},{textSerializers:c})}}})]}}),Xe=()=>({editor:e,view:t})=>(requestAnimationFrame(()=>{var n;e.isDestroyed||(t.dom.blur(),(n=window?.getSelection())===null||n===void 0||n.removeAllRanges())}),!0),tn=(e=!1)=>({commands:t})=>t.setContent("",e),en=()=>({state:e,tr:t,dispatch:n})=>{const{selection:s}=t,{ranges:r}=s;return n&&r.forEach(({$from:i,$to:o})=>{e.doc.nodesBetween(i.pos,o.pos,(a,c)=>{if(a.type.isText)return;const{doc:d,mapping:p}=t,l=d.resolve(p.map(c)),u=d.resolve(p.map(c+a.nodeSize)),f=l.blockRange(u);if(!f)return;const h=ge(f);if(a.type.isTextblock){const{defaultType:m}=l.parent.contentMatchAt(l.index());t.setNodeMarkup(f.start,m)}(h||h===0)&&t.lift(f,h)})}),!0},nn=e=>t=>e(t),sn=()=>({state:e,dispatch:t})=>ve(e,t),rn=(e,t)=>({editor:n,tr:s})=>{const{state:r}=n,i=r.doc.slice(e.from,e.to);s.deleteRange(e.from,e.to);const o=s.mapping.map(t);return s.insert(o,i.content),s.setSelection(new L(s.doc.resolve(o-1))),!0},on=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,s=n.$anchor.node();if(s.content.size>0)return!1;const r=e.selection.$anchor;for(let i=r.depth;i>0;i-=1)if(r.node(i).type===s.type){if(t){const a=r.before(i),c=r.after(i);e.delete(a,c).scrollIntoView()}return!0}return!1},an=e=>({tr:t,state:n,dispatch:s})=>{const r=T(e,n.schema),i=t.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r){if(s){const c=i.before(o),d=i.after(o);t.delete(c,d).scrollIntoView()}return!0}return!1},cn=e=>({tr:t,dispatch:n})=>{const{from:s,to:r}=e;return n&&t.delete(s,r),!0},dn=()=>({state:e,dispatch:t})=>ke(e,t),ln=()=>({commands:e})=>e.keyboardShortcut("Enter"),un=()=>({state:e,dispatch:t})=>Me(e,t);function U(e,t,n={strict:!0}){const s=Object.keys(t);return s.length?s.every(r=>n.strict?t[r]===e[r]:yt(t[r])?t[r].test(e[r]):t[r]===e[r]):!0}function ut(e,t,n={}){return e.find(s=>s.type===t&&U(s.attrs,n))}function pn(e,t,n={}){return!!ut(e,t,n)}function bt(e,t,n={}){if(!e||!t)return;let s=e.parent.childAfter(e.parentOffset);if(e.parentOffset===s.offset&&s.offset!==0&&(s=e.parent.childBefore(e.parentOffset)),!s.node)return;const r=ut([...s.node.marks],t,n);if(!r)return;let i=s.index,o=e.start()+s.offset,a=i+1,c=o+s.node.nodeSize;for(ut([...s.node.marks],t,n);i>0&&r.isInSet(e.parent.child(i-1).marks);)i-=1,o-=e.parent.child(i).nodeSize;for(;a<e.parent.childCount&&pn([...e.parent.child(a).marks],t,n);)c+=e.parent.child(a).nodeSize,a+=1;return{from:o,to:c}}function I(e,t){if(typeof e=="string"){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}const fn=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const i=I(e,s.schema),{doc:o,selection:a}=n,{$from:c,from:d,to:p}=a;if(r){const l=bt(c,i,t);if(l&&l.from<=d&&l.to>=p){const u=L.create(o,l.from,l.to);n.setSelection(u)}}return!0},hn=e=>t=>{const n=typeof e=="function"?e(t):e;for(let s=0;s<n.length;s+=1)if(n[s](t))return!0;return!1};function vt(e){return e instanceof L}function $(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function Kt(e,t=null){if(!t)return null;const n=j.atStart(e),s=j.atEnd(e);if(t==="start"||t===!0)return n;if(t==="end")return s;const r=n.from,i=s.to;return t==="all"?L.create(e,$(0,r,i),$(e.content.size,r,i)):L.create(e,$(t,r,i),$(t,r,i))}function kt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const mn=(e=null,t={})=>({editor:n,view:s,tr:r,dispatch:i})=>{t={scrollIntoView:!0,...t};const o=()=>{kt()&&s.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(s.focus(),t?.scrollIntoView&&n.commands.scrollIntoView())})};if(s.hasFocus()&&e===null||e===!1)return!0;if(i&&e===null&&!vt(n.state.selection))return o(),!0;const a=Kt(r.doc,e)||n.state.selection,c=n.state.selection.eq(a);return i&&(c||r.setSelection(a),c&&r.storedMarks&&r.setStoredMarks(r.storedMarks),o()),!0},gn=(e,t)=>n=>e.every((s,r)=>t(s,{...n,index:r})),yn=(e,t)=>({tr:n,commands:s})=>s.insertContentAt({from:n.selection.from,to:n.selection.to},e,t);function Et(e){const t=`<body>${e}</body>`;return new window.DOMParser().parseFromString(t,"text/html").body}function G(e,t,n){if(n={slice:!0,parseOptions:{},...n},typeof e=="object"&&e!==null)try{return Array.isArray(e)&&e.length>0?V.fromArray(e.map(s=>t.nodeFromJSON(s))):t.nodeFromJSON(e)}catch(s){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",s),G("",t,n)}if(typeof e=="string"){const s=pe.fromSchema(t);return n.slice?s.parseSlice(Et(e),n.parseOptions).content:s.parse(Et(e),n.parseOptions)}return G("",t,n)}function bn(e,t,n){const s=e.steps.length-1;if(s<t)return;const r=e.steps[s];if(!(r instanceof ye||r instanceof be))return;const i=e.mapping.maps[s];let o=0;i.forEach((a,c,d,p)=>{o===0&&(o=p)}),e.setSelection(j.near(e.doc.resolve(o),n))}const vn=e=>e.toString().startsWith("<"),kn=(e,t,n)=>({tr:s,dispatch:r,editor:i})=>{if(r){n={parseOptions:{},updateSelection:!0,...n};const o=G(t,i.schema,{parseOptions:{preserveWhitespace:"full",...n.parseOptions}});if(o.toString()==="<>")return!0;let{from:a,to:c}=typeof e=="number"?{from:e,to:e}:{from:e.from,to:e.to},d=!0,p=!0;if((vn(o)?o:[o]).forEach(u=>{u.check(),d=d?u.isText&&u.marks.length===0:!1,p=p?u.isBlock:!1}),a===c&&p){const{parent:u}=s.doc.resolve(a);u.isTextblock&&!u.type.spec.code&&!u.childCount&&(a-=1,c+=1)}d?Array.isArray(t)?s.insertText(t.map(u=>u.text||"").join(""),a,c):typeof t=="object"&&!!t&&!!t.text?s.insertText(t.text,a,c):s.insertText(t,a,c):s.replaceWith(a,c,o),n.updateSelection&&bn(s,s.steps.length-1,-1)}return!0},Mn=()=>({state:e,dispatch:t})=>we(e,t),wn=()=>({state:e,dispatch:t})=>Se(e,t),Sn=()=>({state:e,dispatch:t})=>Te(e,t),Tn=()=>({state:e,dispatch:t})=>xe(e,t),xn=()=>({tr:e,state:t,dispatch:n})=>{try{const s=Rt(t.doc,t.selection.$from.pos,-1);return s==null?!1:(e.join(s,2),n&&n(e),!0)}catch{return!1}},An=()=>({state:e,dispatch:t,tr:n})=>{try{const s=Rt(e.doc,e.selection.$from.pos,1);return s==null?!1:(n.join(s,2),t&&t(n),!0)}catch{return!1}};function Mt(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function En(e){const t=e.split(/-(?!$)/);let n=t[t.length-1];n==="Space"&&(n=" ");let s,r,i,o;for(let a=0;a<t.length-1;a+=1){const c=t[a];if(/^(cmd|meta|m)$/i.test(c))o=!0;else if(/^a(lt)?$/i.test(c))s=!0;else if(/^(c|ctrl|control)$/i.test(c))r=!0;else if(/^s(hift)?$/i.test(c))i=!0;else if(/^mod$/i.test(c))kt()||Mt()?o=!0:r=!0;else throw new Error(`Unrecognized modifier name: ${c}`)}return s&&(n=`Alt-${n}`),r&&(n=`Ctrl-${n}`),o&&(n=`Meta-${n}`),i&&(n=`Shift-${n}`),n}const Cn=e=>({editor:t,view:n,tr:s,dispatch:r})=>{const i=En(e).split(/-(?!$)/),o=i.find(d=>!["Alt","Ctrl","Meta","Shift"].includes(d)),a=new KeyboardEvent("keydown",{key:o==="Space"?" ":o,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),c=t.captureTransaction(()=>{n.someProp("handleKeyDown",d=>d(n,a))});return c?.steps.forEach(d=>{const p=d.map(s.mapping);p&&r&&s.maybeStep(p)}),!0};function F(e,t,n={}){const{from:s,to:r,empty:i}=e.selection,o=t?T(t,e.schema):null,a=[];e.doc.nodesBetween(s,r,(l,u)=>{if(l.isText)return;const f=Math.max(s,u),h=Math.min(r,u+l.nodeSize);a.push({node:l,from:f,to:h})});const c=r-s,d=a.filter(l=>o?o.name===l.node.type.name:!0).filter(l=>U(l.node.attrs,n,{strict:!1}));return i?!!d.length:d.reduce((l,u)=>l+u.to-u.from,0)>=c}const Ln=(e,t={})=>({state:n,dispatch:s})=>{const r=T(e,n.schema);return F(n,r,t)?Ae(n,s):!1},On=()=>({state:e,dispatch:t})=>Ee(e,t),Hn=e=>({state:t,dispatch:n})=>{const s=T(e,t.schema);return Ie(s)(t,n)},Pn=()=>({state:e,dispatch:t})=>Ce(e,t);function nt(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function Ct(e,t){const n=typeof t=="string"?[t]:t;return Object.keys(e).reduce((s,r)=>(n.includes(r)||(s[r]=e[r]),s),{})}const $n=(e,t)=>({tr:n,state:s,dispatch:r})=>{let i=null,o=null;const a=nt(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(i=T(e,s.schema)),a==="mark"&&(o=I(e,s.schema)),r&&n.selection.ranges.forEach(c=>{s.doc.nodesBetween(c.$from.pos,c.$to.pos,(d,p)=>{i&&i===d.type&&n.setNodeMarkup(p,void 0,Ct(d.attrs,t)),o&&d.marks.length&&d.marks.forEach(l=>{o===l.type&&n.addMark(p,p+d.nodeSize,o.create(Ct(l.attrs,t)))})})}),!0):!1},Bn=()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0),In=()=>({tr:e,commands:t})=>t.setTextSelection({from:0,to:e.doc.content.size}),Nn=()=>({state:e,dispatch:t})=>Le(e,t),Rn=()=>({state:e,dispatch:t})=>Oe(e,t),jn=()=>({state:e,dispatch:t})=>He(e,t),_n=()=>({state:e,dispatch:t})=>Pe(e,t),Dn=()=>({state:e,dispatch:t})=>$e(e,t);function zt(e,t,n={}){return G(e,t,{slice:!1,parseOptions:n})}const Fn=(e,t=!1,n={})=>({tr:s,editor:r,dispatch:i})=>{const{doc:o}=s,a=zt(e,r.schema,n);return i&&s.replaceWith(0,o.content.size,a).setMeta("preventUpdate",!t),!0};function st(e,t){const n=I(t,e.schema),{from:s,to:r,empty:i}=e.selection,o=[];i?(e.storedMarks&&o.push(...e.storedMarks),o.push(...e.selection.$head.marks())):e.doc.nodesBetween(s,r,c=>{o.push(...c.marks)});const a=o.find(c=>c.type.name===n.name);return a?{...a.attrs}:{}}function Kn(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function zn(e,t){for(let n=e.depth;n>0;n-=1){const s=e.node(n);if(t(s))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:s}}}function wt(e){return t=>zn(t.$from,e)}function Vn(e,t){const n=fe.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function Wn(e,t){const n={from:0,to:e.content.size};return Dt(e,n,t)}function qn(e,t){const n=T(t,e.schema),{from:s,to:r}=e.selection,i=[];e.doc.nodesBetween(s,r,a=>{i.push(a)});const o=i.reverse().find(a=>a.type.name===n.name);return o?{...o.attrs}:{}}function Un(e,t){const n=nt(typeof t=="string"?t:t.name,e.schema);return n==="node"?qn(e,t):n==="mark"?st(e,t):{}}function Vt(e,t,n){const s=[];return e===t?n.resolve(e).marks().forEach(r=>{const i=n.resolve(e-1),o=bt(i,r.type);!o||s.push({mark:r,...o})}):n.nodesBetween(e,t,(r,i)=>{s.push(...r.marks.map(o=>({from:i,to:i+r.nodeSize,mark:o})))}),s}function q(e,t,n){return Object.fromEntries(Object.entries(n).filter(([s])=>{const r=e.find(i=>i.type===t&&i.name===s);return r?r.attribute.keepOnSplit:!1}))}function pt(e,t,n={}){const{empty:s,ranges:r}=e.selection,i=t?I(t,e.schema):null;if(s)return!!(e.storedMarks||e.selection.$from.marks()).filter(l=>i?i.name===l.type.name:!0).find(l=>U(l.attrs,n,{strict:!1}));let o=0;const a=[];if(r.forEach(({$from:l,$to:u})=>{const f=l.pos,h=u.pos;e.doc.nodesBetween(f,h,(m,g)=>{if(!m.isText&&!m.marks.length)return;const b=Math.max(f,g),v=Math.min(h,g+m.nodeSize);o+=v-b,a.push(...m.marks.map(x=>({mark:x,from:b,to:v})))})}),o===0)return!1;const c=a.filter(l=>i?i.name===l.mark.type.name:!0).filter(l=>U(l.mark.attrs,n,{strict:!1})).reduce((l,u)=>l+u.to-u.from,0),d=a.filter(l=>i?l.mark.type!==i&&l.mark.type.excludes(i):!0).reduce((l,u)=>l+u.to-u.from,0);return(c>0?c+d:c)>=o}function Gn(e,t,n={}){if(!t)return F(e,null,n)||pt(e,null,n);const s=nt(t,e.schema);return s==="node"?F(e,t,n):s==="mark"?pt(e,t,n):!1}function Lt(e,t){const{nodeExtensions:n}=X(t),s=n.find(o=>o.name===e);if(!s)return!1;const r={name:s.name,options:s.options,storage:s.storage},i=k(y(s,"group",r));return typeof i!="string"?!1:i.split(" ").includes("list")}function Jn(e){var t;const n=(t=e.type.createAndFill())===null||t===void 0?void 0:t.toJSON(),s=e.toJSON();return JSON.stringify(n)===JSON.stringify(s)}function Zn(e){return e instanceof J}function Wt(e,t,n){const r=e.state.doc.content.size,i=$(t,0,r),o=$(n,0,r),a=e.coordsAtPos(i),c=e.coordsAtPos(o,-1),d=Math.min(a.top,c.top),p=Math.max(a.bottom,c.bottom),l=Math.min(a.left,c.left),u=Math.max(a.right,c.right),f=u-l,h=p-d,b={top:d,bottom:p,left:l,right:u,width:f,height:h,x:l,y:d};return{...b,toJSON:()=>b}}function Yn(e,t,n){var s;const{selection:r}=t;let i=null;if(vt(r)&&(i=r.$cursor),i){const a=(s=e.storedMarks)!==null&&s!==void 0?s:i.marks();return!!n.isInSet(a)||!a.some(c=>c.type.excludes(n))}const{ranges:o}=r;return o.some(({$from:a,$to:c})=>{let d=a.depth===0?e.doc.inlineContent&&e.doc.type.allowsMarkType(n):!1;return e.doc.nodesBetween(a.pos,c.pos,(p,l,u)=>{if(d)return!1;if(p.isInline){const f=!u||u.type.allowsMarkType(n),h=!!n.isInSet(p.marks)||!p.marks.some(m=>m.type.excludes(n));d=f&&h}return!d}),d})}const Qn=(e,t={})=>({tr:n,state:s,dispatch:r})=>{const{selection:i}=n,{empty:o,ranges:a}=i,c=I(e,s.schema);if(r)if(o){const d=st(s,c);n.addStoredMark(c.create({...d,...t}))}else a.forEach(d=>{const p=d.$from.pos,l=d.$to.pos;s.doc.nodesBetween(p,l,(u,f)=>{const h=Math.max(f,p),m=Math.min(f+u.nodeSize,l);u.marks.find(b=>b.type===c)?u.marks.forEach(b=>{c===b.type&&n.addMark(h,m,c.create({...b.attrs,...t}))}):n.addMark(h,m,c.create(t))})});return Yn(s,n,c)},Xn=(e,t)=>({tr:n})=>(n.setMeta(e,t),!0),ts=(e,t={})=>({state:n,dispatch:s,chain:r})=>{const i=T(e,n.schema);return i.isTextblock?r().command(({commands:o})=>St(i,t)(n)?!0:o.clearNodes()).command(({state:o})=>St(i,t)(o,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},es=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,r=$(e,0,s.content.size),i=J.create(s,r);t.setSelection(i)}return!0},ns=e=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,{from:r,to:i}=typeof e=="number"?{from:e,to:e}:e,o=L.atStart(s).from,a=L.atEnd(s).to,c=$(r,o,a),d=$(i,o,a),p=L.create(s,c,d);t.setSelection(p)}return!0},ss=e=>({state:t,dispatch:n})=>{const s=T(e,t.schema);return Ne(s)(t,n)};function Ot(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const s=n.filter(r=>t?.includes(r.type.name));e.tr.ensureMarks(s)}}const rs=({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:s,editor:r})=>{const{selection:i,doc:o}=t,{$from:a,$to:c}=i,d=r.extensionManager.attributes,p=q(d,a.node().type.name,a.node().attrs);if(i instanceof J&&i.node.isBlock)return!a.parentOffset||!W(o,a.pos)?!1:(s&&(e&&Ot(n,r.extensionManager.splittableMarks),t.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;if(s){const l=c.parentOffset===c.parent.content.size;i instanceof L&&t.deleteSelection();const u=a.depth===0?void 0:Kn(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=l&&u?[{type:u,attrs:p}]:void 0,h=W(t.doc,t.mapping.map(a.pos),1,f);if(!f&&!h&&W(t.doc,t.mapping.map(a.pos),1,u?[{type:u}]:void 0)&&(h=!0,f=u?[{type:u,attrs:p}]:void 0),h&&(t.split(t.mapping.map(a.pos),1,f),u&&!l&&!a.parentOffset&&a.parent.type!==u)){const m=t.mapping.map(a.before()),g=t.doc.resolve(m);a.node(-1).canReplaceWith(g.index(),g.index()+1,u)&&t.setNodeMarkup(t.mapping.map(a.before()),u)}e&&Ot(n,r.extensionManager.splittableMarks),t.scrollIntoView()}return!0},os=e=>({tr:t,state:n,dispatch:s,editor:r})=>{var i;const o=T(e,n.schema),{$from:a,$to:c}=n.selection,d=n.selection.node;if(d&&d.isBlock||a.depth<2||!a.sameParent(c))return!1;const p=a.node(-1);if(p.type!==o)return!1;const l=r.extensionManager.attributes;if(a.parent.content.size===0&&a.node(-1).childCount===a.indexAfter(-1)){if(a.depth===2||a.node(-3).type!==o||a.index(-2)!==a.node(-2).childCount-1)return!1;if(s){let g=V.empty;const b=a.index(-1)?1:a.index(-2)?2:3;for(let O=a.depth-b;O>=a.depth-3;O-=1)g=V.from(a.node(O).copy(g));const v=a.indexAfter(-1)<a.node(-2).childCount?1:a.indexAfter(-2)<a.node(-3).childCount?2:3,M=q(l,a.node().type.name,a.node().attrs),x=((i=o.contentMatch.defaultType)===null||i===void 0?void 0:i.createAndFill(M))||void 0;g=g.append(V.from(o.createAndFill(null,x)||void 0));const C=a.before(a.depth-(b-1));t.replace(C,a.after(-v),new ue(g,4-b,0));let w=-1;t.doc.nodesBetween(C,t.doc.content.size,(O,rt)=>{if(w>-1)return!1;O.isTextblock&&O.content.size===0&&(w=rt+1)}),w>-1&&t.setSelection(L.near(t.doc.resolve(w))),t.scrollIntoView()}return!0}const u=c.pos===a.end()?p.contentMatchAt(0).defaultType:null,f=q(l,p.type.name,p.attrs),h=q(l,a.node().type.name,a.node().attrs);t.delete(a.pos,c.pos);const m=u?[{type:o,attrs:f},{type:u,attrs:h}]:[{type:o,attrs:f}];if(!W(t.doc,a.pos,2))return!1;if(s){const{selection:g,storedMarks:b}=n,{splittableMarks:v}=r.extensionManager,M=b||g.$to.parentOffset&&g.$from.marks();if(t.split(a.pos,2,m).scrollIntoView(),!M||!s)return!0;const x=M.filter(C=>v.includes(C.type.name));t.ensureMarks(x)}return!0},ct=(e,t)=>{const n=wt(o=>o.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===r?.type&&gt(e.doc,n.pos)&&e.join(n.pos),!0},dt=(e,t)=>{const n=wt(o=>o.type===t)(e.selection);if(!n)return!0;const s=e.doc.resolve(n.start).after(n.depth);if(s===void 0)return!0;const r=e.doc.nodeAt(s);return n.node.type===r?.type&&gt(e.doc,s)&&e.join(s),!0},is=(e,t,n,s={})=>({editor:r,tr:i,state:o,dispatch:a,chain:c,commands:d,can:p})=>{const{extensions:l,splittableMarks:u}=r.extensionManager,f=T(e,o.schema),h=T(t,o.schema),{selection:m,storedMarks:g}=o,{$from:b,$to:v}=m,M=b.blockRange(v),x=g||m.$to.parentOffset&&m.$from.marks();if(!M)return!1;const C=wt(w=>Lt(w.type.name,l))(m);if(M.depth>=1&&C&&M.depth-C.depth<=1){if(C.node.type===f)return d.liftListItem(h);if(Lt(C.node.type.name,l)&&f.validContent(C.node.content)&&a)return c().command(()=>(i.setNodeMarkup(C.pos,f),!0)).command(()=>ct(i,f)).command(()=>dt(i,f)).run()}return!n||!x||!a?c().command(()=>p().wrapInList(f,s)?!0:d.clearNodes()).wrapInList(f,s).command(()=>ct(i,f)).command(()=>dt(i,f)).run():c().command(()=>{const w=p().wrapInList(f,s),O=x.filter(rt=>u.includes(rt.type.name));return i.ensureMarks(O),w?!0:d.clearNodes()}).wrapInList(f,s).command(()=>ct(i,f)).command(()=>dt(i,f)).run()},as=(e,t={},n={})=>({state:s,commands:r})=>{const{extendEmptyMarkRange:i=!1}=n,o=I(e,s.schema);return pt(s,o,t)?r.unsetMark(o,{extendEmptyMarkRange:i}):r.setMark(o,t)},cs=(e,t,n={})=>({state:s,commands:r})=>{const i=T(e,s.schema),o=T(t,s.schema);return F(s,i,n)?r.setNode(o):r.setNode(i,n)},ds=(e,t={})=>({state:n,commands:s})=>{const r=T(e,n.schema);return F(n,r,t)?s.lift(r):s.wrapIn(r,t)},ls=()=>({state:e,dispatch:t})=>{const n=e.plugins;for(let s=0;s<n.length;s+=1){const r=n[s];let i;if(r.spec.isInputRules&&(i=r.getState(e))){if(t){const o=e.tr,a=i.transform;for(let c=a.steps.length-1;c>=0;c-=1)o.step(a.steps[c].invert(a.docs[c]));if(i.text){const c=o.doc.resolve(i.from).marks();o.replaceWith(i.from,i.to,e.schema.text(i.text,c))}else o.delete(i.from,i.to)}return!0}}return!1},us=()=>({tr:e,dispatch:t})=>{const{selection:n}=e,{empty:s,ranges:r}=n;return s||t&&r.forEach(i=>{e.removeMark(i.$from.pos,i.$to.pos)}),!0},ps=(e,t={})=>({tr:n,state:s,dispatch:r})=>{var i;const{extendEmptyMarkRange:o=!1}=t,{selection:a}=n,c=I(e,s.schema),{$from:d,empty:p,ranges:l}=a;if(!r)return!0;if(p&&o){let{from:u,to:f}=a;const h=(i=d.marks().find(g=>g.type===c))===null||i===void 0?void 0:i.attrs,m=bt(d,c,h);m&&(u=m.from,f=m.to),n.removeMark(u,f,c)}else l.forEach(u=>{n.removeMark(u.$from.pos,u.$to.pos,c)});return n.removeStoredMark(c),!0},fs=(e,t={})=>({tr:n,state:s,dispatch:r})=>{let i=null,o=null;const a=nt(typeof e=="string"?e:e.name,s.schema);return a?(a==="node"&&(i=T(e,s.schema)),a==="mark"&&(o=I(e,s.schema)),r&&n.selection.ranges.forEach(c=>{const d=c.$from.pos,p=c.$to.pos;s.doc.nodesBetween(d,p,(l,u)=>{i&&i===l.type&&n.setNodeMarkup(u,void 0,{...l.attrs,...t}),o&&l.marks.length&&l.marks.forEach(f=>{if(o===f.type){const h=Math.max(u,d),m=Math.min(u+l.nodeSize,p);n.addMark(h,m,o.create({...f.attrs,...t}))}})})}),!0):!1},hs=(e,t={})=>({state:n,dispatch:s})=>{const r=T(e,n.schema);return Be(r,t)(n,s)},ms=(e,t={})=>({state:n,dispatch:s})=>{const r=T(e,n.schema);return Re(r,t)(n,s)};var gs=Object.freeze({__proto__:null,blur:Xe,clearContent:tn,clearNodes:en,command:nn,createParagraphNear:sn,cut:rn,deleteCurrentNode:on,deleteNode:an,deleteRange:cn,deleteSelection:dn,enter:ln,exitCode:un,extendMarkRange:fn,first:hn,focus:mn,forEach:gn,insertContent:yn,insertContentAt:kn,joinUp:Mn,joinDown:wn,joinBackward:Sn,joinForward:Tn,joinItemBackward:xn,joinItemForward:An,keyboardShortcut:Cn,lift:Ln,liftEmptyBlock:On,liftListItem:Hn,newlineInCode:Pn,resetAttributes:$n,scrollIntoView:Bn,selectAll:In,selectNodeBackward:Nn,selectNodeForward:Rn,selectParentNode:jn,selectTextblockEnd:_n,selectTextblockStart:Dn,setContent:Fn,setMark:Qn,setMeta:Xn,setNode:ts,setNodeSelection:es,setTextSelection:ns,sinkListItem:ss,splitBlock:rs,splitListItem:os,toggleList:is,toggleMark:as,toggleNode:cs,toggleWrap:ds,undoInputRule:ls,unsetAllMarks:us,unsetMark:ps,updateAttributes:fs,wrapIn:hs,wrapInList:ms});const ys=A.create({name:"commands",addCommands(){return{...gs}}}),bs=A.create({name:"editable",addProseMirrorPlugins(){return[new P({key:new B("editable"),props:{editable:()=>this.editor.options.editable}})]}}),vs=A.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new P({key:new B("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const s=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1},blur:(t,n)=>{e.isFocused=!1;const s=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1}}}})]}}),ks=A.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:o})=>[()=>o.undoInputRule(),()=>o.command(({tr:a})=>{const{selection:c,doc:d}=a,{empty:p,$anchor:l}=c,{pos:u,parent:f}=l,h=l.parent.isTextblock?a.doc.resolve(u-1):l,m=h.parent.type.spec.isolating,g=l.pos-l.parentOffset,b=m&&h.parent.childCount===1?g===l.pos:j.atStart(d).from===u;return!p||!b||!f.type.isTextblock||f.textContent.length?!1:o.clearNodes()}),()=>o.deleteSelection(),()=>o.joinBackward(),()=>o.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:o})=>[()=>o.deleteSelection(),()=>o.deleteCurrentNode(),()=>o.joinForward(),()=>o.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:o})=>[()=>o.newlineInCode(),()=>o.createParagraphNear(),()=>o.liftEmptyBlock(),()=>o.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...s},i={...s,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return kt()||Mt()?i:r},addProseMirrorPlugins(){return[new P({key:new B("clearDocument"),appendTransaction:(e,t,n)=>{if(!(e.some(h=>h.docChanged)&&!t.doc.eq(n.doc)))return;const{empty:r,from:i,to:o}=t.selection,a=j.atStart(t.doc).from,c=j.atEnd(t.doc).to;if(r||!(i===a&&o===c)||!(n.doc.textBetween(0,n.doc.content.size," "," ").length===0))return;const l=n.tr,u=Y({state:n,transaction:l}),{commands:f}=new Q({editor:this.editor,state:u});if(f.clearNodes(),!!l.steps.length)return l}})]}}),Ms=A.create({name:"tabindex",addProseMirrorPlugins(){return[new P({key:new B("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var ws=Object.freeze({__proto__:null,ClipboardTextSerializer:Qe,Commands:ys,Editable:bs,FocusEvents:vs,Keymap:ks,Tabindex:Ms});const Ss=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 1px !important;
  height: 1px !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function Ts(e,t,n){const s=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(s!==null)return s;const r=document.createElement("style");return t&&r.setAttribute("nonce",t),r.setAttribute(`data-tiptap-style${n?`-${n}`:""}`,""),r.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(r),r}class xs extends je{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=Ts(Ss,this.options.injectNonce))}setOptions(t={}){this.options={...this.options,...t},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t,n=!0){this.setOptions({editable:t}),n&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const s=_t(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],r=this.state.reconfigure({plugins:s});this.view.updateState(r)}unregisterPlugin(t){if(this.isDestroyed)return;const n=typeof t=="string"?`${t}$`:t.key,s=this.state.reconfigure({plugins:this.state.plugins.filter(r=>!r.key.startsWith(n))});this.view.updateState(s)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(ws):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(s?.type));this.extensionManager=new R(n,this)}createCommandManager(){this.commandManager=new Q({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=zt(this.options.content,this.schema,this.options.parseOptions),n=Kt(t,this.options.autofocus);this.view=new de(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:Gt.create({doc:t,selection:n||void 0})});const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.prependClass();const r=this.view.dom;r.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=t;return}t.steps.forEach(o=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(o)});return}const n=this.state.apply(t),s=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),s&&this.emit("selectionUpdate",{editor:this,transaction:t});const r=t.getMeta("focus"),i=t.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:t}),i&&this.emit("blur",{editor:this,event:i.event,transaction:t}),!(!t.docChanged||t.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Un(this.state,t)}isActive(t,n){const s=typeof t=="string"?t:null,r=typeof t=="string"?n:t;return Gn(this.state,s,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Vn(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n=`

`,textSerializers:s={}}=t||{};return Wn(this.state.doc,{blockSeparator:n,textSerializers:{...Ft(this.schema),...s}})}get isEmpty(){return Jn(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(!((t=this.view)===null||t===void 0)&&t.docView)}}function _(e){return new tt({find:e.find,handler:({state:t,range:n,match:s})=>{const r=k(e.getAttributes,void 0,s);if(r===!1||r===null)return null;const{tr:i}=t,o=s[s.length-1],a=s[0];if(o){const c=a.search(/\S/),d=n.from+a.indexOf(o),p=d+o.length;if(Vt(n.from,n.to,t.doc).filter(f=>f.mark.type.excluded.find(m=>m===e.type&&m!==f.mark.type)).filter(f=>f.to>d).length)return null;p<n.to&&i.delete(p,n.to),d>n.from&&i.delete(n.from+c,d);const u=n.from+c+o.length;i.addMark(n.from+c,u,e.type.create(r||{})),i.removeStoredMark(e.type)}}})}function As(e){return new tt({find:e.find,handler:({state:t,range:n,match:s})=>{const r=k(e.getAttributes,void 0,s)||{},{tr:i}=t,o=n.from;let a=n.to;const c=e.type.create(r);if(s[1]){const d=s[0].lastIndexOf(s[1]);let p=o+d;p>a?p=a:a=p+s[1].length;const l=s[0][s[0].length-1];i.insertText(l,o+s[0].length-1),i.replaceWith(p,a,c)}else s[0]&&i.insert(o-1,e.type.create(r)).delete(i.mapping.map(o),i.mapping.map(a));i.scrollIntoView()}})}function ft(e){return new tt({find:e.find,handler:({state:t,range:n,match:s})=>{const r=t.doc.resolve(n.from),i=k(e.getAttributes,void 0,s)||{};if(!r.node(-1).canReplaceWith(r.index(-1),r.indexAfter(-1),e.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,e.type,i)}})}function K(e){return new tt({find:e.find,handler:({state:t,range:n,match:s,chain:r})=>{const i=k(e.getAttributes,void 0,s)||{},o=t.tr.delete(n.from,n.to),c=o.doc.resolve(n.from).blockRange(),d=c&&me(c,e.type,i);if(!d)return null;if(o.wrap(c,d),e.keepMarks&&e.editor){const{selection:l,storedMarks:u}=t,{splittableMarks:f}=e.editor.extensionManager,h=u||l.$to.parentOffset&&l.$from.marks();if(h){const m=h.filter(g=>f.includes(g.type.name));o.ensureMarks(m)}}if(e.keepAttributes){const l=e.type.name==="bulletList"||e.type.name==="orderedList"?"listItem":"taskList";r().updateAttributes(l,i).run()}const p=o.doc.resolve(n.from-1).nodeBefore;p&&p.type===e.type&&gt(o.doc,n.from-1)&&(!e.joinPredicate||e.joinPredicate(s,p))&&o.join(n.from-1)}})}class H{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=k(y(this,"addOptions",{name:this.name}))),this.storage=k(y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new H(t)}configure(t={}){const n=this.extend();return n.options=et(this.options,t),n.storage=k(y(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new H(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=k(y(n,"addOptions",{name:n.name})),n.storage=k(y(n,"addStorage",{name:n.name,options:n.options})),n}static handleExit({editor:t,mark:n}){const{tr:s}=t.state,r=t.state.selection.$from;if(r.pos===r.end()){const o=r.marks();if(!!!o.find(d=>d?.type.name===n.name))return!1;const c=o.find(d=>d?.type.name===n.name);return c&&s.removeStoredMark(c),s.insertText(" ",r.pos),t.view.dispatch(s),!0}return!1}}class E{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...t},this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=k(y(this,"addOptions",{name:this.name}))),this.storage=k(y(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new E(t)}configure(t={}){const n=this.extend();return n.options=et(this.options,t),n.storage=k(y(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new E(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=k(y(n,"addOptions",{name:n.name})),n.storage=k(y(n,"addStorage",{name:n.name,options:n.options})),n}}function D(e){return new qe({find:e.find,handler:({state:t,range:n,match:s,pasteEvent:r})=>{const i=k(e.getAttributes,void 0,s,r);if(i===!1||i===null)return null;const{tr:o}=t,a=s[s.length-1],c=s[0];let d=n.to;if(a){const p=c.search(/\S/),l=n.from+c.indexOf(a),u=l+a.length;if(Vt(n.from,n.to,t.doc).filter(h=>h.mark.type.excluded.find(g=>g===e.type&&g!==h.mark.type)).filter(h=>h.to>l).length)return null;u<n.to&&o.delete(u,n.to),l>n.from&&o.delete(n.from+p,l),d=n.from+p+a.length,o.addMark(n.from+p,d,e.type.create(i||{})),o.removeStoredMark(e.type)}}})}class Es{constructor({editor:t,element:n,view:s,tippyOptions:r={},updateDelay:i=250,shouldShow:o}){this.preventHide=!1,this.shouldShow=({view:a,state:c,from:d,to:p})=>{const{doc:l,selection:u}=c,{empty:f}=u,h=!l.textBetween(d,p).length&&vt(c.selection),m=this.element.contains(document.activeElement);return!(!(a.hasFocus()||m)||f||h||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:a})=>{var c;if(this.preventHide){this.preventHide=!1;return}a?.relatedTarget&&((c=this.element.parentNode)===null||c===void 0?void 0:c.contains(a.relatedTarget))||this.hide()},this.tippyBlurHandler=a=>{this.blurHandler({event:a})},this.handleDebouncedUpdate=(a,c)=>{const d=!c?.selection.eq(a.state.selection),p=!c?.doc.eq(a.state.doc);!d&&!p||(this.updateDebounceTimer&&clearTimeout(this.updateDebounceTimer),this.updateDebounceTimer=window.setTimeout(()=>{this.updateHandler(a,d,p,c)},this.updateDelay))},this.updateHandler=(a,c,d,p)=>{var l,u,f;const{state:h,composing:m}=a,{selection:g}=h;if(m||!c&&!d)return;this.createTooltip();const{ranges:v}=g,M=Math.min(...v.map(w=>w.$from.pos)),x=Math.max(...v.map(w=>w.$to.pos));if(!((l=this.shouldShow)===null||l===void 0?void 0:l.call(this,{editor:this.editor,view:a,state:h,oldState:p,from:M,to:x}))){this.hide();return}(u=this.tippy)===null||u===void 0||u.setProps({getReferenceClientRect:((f=this.tippyOptions)===null||f===void 0?void 0:f.getReferenceClientRect)||(()=>{if(Zn(h.selection)){let w=a.nodeDOM(M);const O=w.dataset.nodeViewWrapper?w:w.querySelector("[data-node-view-wrapper]");if(O&&(w=O.firstChild),w)return w.getBoundingClientRect()}return Wt(a,M,x)})}),this.show()},this.editor=t,this.element=n,this.view=s,this.updateDelay=i,o&&(this.shouldShow=o),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=Nt(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){const{state:s}=t,r=s.selection.$from.pos!==s.selection.$to.pos;if(this.updateDelay>0&&r){this.handleDebouncedUpdate(t,n);return}const i=!n?.selection.eq(t.state.selection),o=!n?.doc.eq(t.state.doc);this.updateHandler(t,i,o,n)}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const qt=e=>new P({key:typeof e.pluginKey=="string"?new B(e.pluginKey):e.pluginKey,view:t=>new Es({view:t,...e})});A.create({name:"bubbleMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"bubbleMenu",updateDelay:void 0,shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[qt({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,updateDelay:this.options.updateDelay,shouldShow:this.options.shouldShow})]:[]}});class Cs{constructor({editor:t,element:n,view:s,tippyOptions:r={},shouldShow:i}){this.preventHide=!1,this.shouldShow=({view:o,state:a})=>{const{selection:c}=a,{$anchor:d,empty:p}=c,l=d.depth===1,u=d.parent.isTextblock&&!d.parent.type.spec.code&&!d.parent.textContent;return!(!o.hasFocus()||!p||!l||!u||!this.editor.isEditable)},this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:o})=>{var a;if(this.preventHide){this.preventHide=!1;return}o?.relatedTarget&&((a=this.element.parentNode)===null||a===void 0?void 0:a.contains(o.relatedTarget))||this.hide()},this.tippyBlurHandler=o=>{this.blurHandler({event:o})},this.editor=t,this.element=n,this.view=s,i&&(this.shouldShow=i),this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.tippyOptions=r,this.element.remove(),this.element.style.visibility="visible"}createTooltip(){const{element:t}=this.editor.options,n=!!t.parentElement;this.tippy||!n||(this.tippy=Nt(t,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...this.tippyOptions}),this.tippy.popper.firstChild&&this.tippy.popper.firstChild.addEventListener("blur",this.tippyBlurHandler))}update(t,n){var s,r,i;const{state:o}=t,{doc:a,selection:c}=o,{from:d,to:p}=c;if(n&&n.doc.eq(a)&&n.selection.eq(c))return;if(this.createTooltip(),!((s=this.shouldShow)===null||s===void 0?void 0:s.call(this,{editor:this.editor,view:t,state:o,oldState:n}))){this.hide();return}(r=this.tippy)===null||r===void 0||r.setProps({getReferenceClientRect:((i=this.tippyOptions)===null||i===void 0?void 0:i.getReferenceClientRect)||(()=>Wt(t,d,p))}),this.show()}show(){var t;(t=this.tippy)===null||t===void 0||t.show()}hide(){var t;(t=this.tippy)===null||t===void 0||t.hide()}destroy(){var t,n;!((t=this.tippy)===null||t===void 0)&&t.popper.firstChild&&this.tippy.popper.firstChild.removeEventListener("blur",this.tippyBlurHandler),(n=this.tippy)===null||n===void 0||n.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const Ut=e=>new P({key:typeof e.pluginKey=="string"?new B(e.pluginKey):e.pluginKey,view:t=>new Cs({view:t,...e})});A.create({name:"floatingMenu",addOptions(){return{element:null,tippyOptions:{},pluginKey:"floatingMenu",shouldShow:null}},addProseMirrorPlugins(){return this.options.element?[Ut({pluginKey:this.options.pluginKey,editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions,shouldShow:this.options.shouldShow})]:[]}});z({name:"BubbleMenu",props:{pluginKey:{type:[String,Object],default:"bubbleMenu"},editor:{type:Object,required:!0},updateDelay:{type:Number,default:void 0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const n=ht(null);return mt(()=>{const{updateDelay:s,editor:r,pluginKey:i,shouldShow:o,tippyOptions:a}=e;r.registerPlugin(qt({updateDelay:s,editor:r,element:n.value,pluginKey:i,shouldShow:o,tippyOptions:a}))}),Z(()=>{const{pluginKey:s,editor:r}=e;r.unregisterPlugin(s)}),()=>{var s;return N("div",{ref:n},(s=t.default)===null||s===void 0?void 0:s.call(t))}}});function Ht(e){return se((t,n)=>({get(){return t(),e},set(s){e=s,requestAnimationFrame(()=>{requestAnimationFrame(()=>{n()})})}}))}class Ls extends xs{constructor(t={}){return super(t),this.vueRenderers=ee(new Map),this.contentComponent=null,this.reactiveState=Ht(this.view.state),this.reactiveExtensionStorage=Ht(this.extensionStorage),this.on("transaction",()=>{this.reactiveState.value=this.view.state,this.reactiveExtensionStorage.value=this.extensionStorage}),ne(this)}get state(){return this.reactiveState?this.reactiveState.value:this.view.state}get storage(){return this.reactiveExtensionStorage?this.reactiveExtensionStorage.value:super.storage}registerPlugin(t,n){super.registerPlugin(t,n),this.reactiveState.value=this.view.state}unregisterPlugin(t){super.unregisterPlugin(t),this.reactiveState.value=this.view.state}}const Sr=z({name:"EditorContent",props:{editor:{default:null,type:Object}},setup(e){const t=ht(),n=Jt();return Zt(()=>{const s=e.editor;s&&s.options.element&&t.value&&Yt(()=>{if(!t.value||!s.options.element.firstChild)return;const r=Qt(t.value);t.value.append(...s.options.element.childNodes),s.contentComponent=n.ctx._,s.setOptions({element:r}),s.createNodeViews()})}),Z(()=>{const s=e.editor;if(!s||(s.isDestroyed||s.view.setProps({nodeViews:{}}),s.contentComponent=null,!s.options.element.firstChild))return;const r=document.createElement("div");r.append(...s.options.element.childNodes),s.setOptions({element:r})}),{rootEl:t}},render(){const e=[];return this.editor&&this.editor.vueRenderers.forEach(t=>{const n=N(Xt,{to:t.teleportElement,key:t.id},N(t.component,{ref:t.id,...t.props}));e.push(n)}),N("div",{ref:t=>{this.rootEl=t}},...e)}});z({name:"FloatingMenu",props:{pluginKey:{type:null,default:"floatingMenu"},editor:{type:Object,required:!0},tippyOptions:{type:Object,default:()=>({})},shouldShow:{type:Function,default:null}},setup(e,{slots:t}){const n=ht(null);return mt(()=>{const{pluginKey:s,editor:r,tippyOptions:i,shouldShow:o}=e;r.registerPlugin(Ut({pluginKey:s,editor:r,element:n.value,tippyOptions:i,shouldShow:o}))}),Z(()=>{const{pluginKey:s,editor:r}=e;r.unregisterPlugin(s)}),()=>{var s;return N("div",{ref:n},(s=t.default)===null||s===void 0?void 0:s.call(t))}}});z({name:"NodeViewContent",props:{as:{type:String,default:"div"}},render(){return N(this.as,{style:{whiteSpace:"pre-wrap"},"data-node-view-content":""})}});z({name:"NodeViewWrapper",props:{as:{type:String,default:"div"}},inject:["onDragStart","decorationClasses"],render(){var e,t;return N(this.as,{class:this.decorationClasses,style:{whiteSpace:"normal"},"data-node-view-wrapper":"",onDragstart:this.onDragStart},(t=(e=this.$slots).default)===null||t===void 0?void 0:t.call(e))}});const Tr=(e={})=>{const t=te();return mt(()=>{t.value=new Ls(e)}),Z(()=>{var n;(n=t.value)===null||n===void 0||n.destroy()}),t},Os=/^\s*>\s$/,Hs=E.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:e}){return["blockquote",S(this.options.HTMLAttributes,e),0]},addCommands(){return{setBlockquote:()=>({commands:e})=>e.wrapIn(this.name),toggleBlockquote:()=>({commands:e})=>e.toggleWrap(this.name),unsetBlockquote:()=>({commands:e})=>e.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[K({find:Os,type:this.type})]}}),Ps=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,$s=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Bs=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Is=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,Ns=H.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",S(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[_({find:Ps,type:this.type}),_({find:Bs,type:this.type})]},addPasteRules(){return[D({find:$s,type:this.type}),D({find:Is,type:this.type})]}}),Rs=E.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",S(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Pt=H.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",S(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=st(e,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:t.unsetMark(this.name)}}}}),$t=/^\s*([-+*])\s$/,js=E.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",S(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Rs.name,this.editor.getAttributes(Pt.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=K({find:$t,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=K({find:$t,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Pt.name),editor:this.editor})),[e]}}),_s=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/,Ds=/(?:^|\s)((?:`)((?:[^`]+))(?:`))/g,Fs=H.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:e}){return["code",S(this.options.HTMLAttributes,e),0]},addCommands(){return{setCode:()=>({commands:e})=>e.setMark(this.name),toggleCode:()=>({commands:e})=>e.toggleMark(this.name),unsetCode:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[_({find:_s,type:this.type})]},addPasteRules(){return[D({find:Ds,type:this.type})]}}),Ks=/^```([a-z]+)?[\s\n]$/,zs=/^~~~([a-z]+)?[\s\n]$/,Vs=E.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,i=[...((t=e.firstElementChild)===null||t===void 0?void 0:t.classList)||[]].filter(o=>o.startsWith(n)).map(o=>o.replace(n,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:e,HTMLAttributes:t}){return["pre",S(this.options.HTMLAttributes,t),["code",{class:e.attrs.language?this.options.languageClassPrefix+e.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>({commands:t})=>t.setNode(this.name,e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode(this.name,"paragraph",e)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=t.pos===1;return!e||t.parent.type.name!==this.name?!1:n||!t.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:e})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:t}=e,{selection:n}=t,{$from:s,empty:r}=n;if(!r||s.parent.type!==this.type)return!1;const i=s.parentOffset===s.parent.nodeSize-2,o=s.parent.textContent.endsWith(`

`);return!i||!o?!1:e.chain().command(({tr:a})=>(a.delete(s.pos-2,s.pos),!0)).exitCode().run()},ArrowDown:({editor:e})=>{if(!this.options.exitOnArrowDown)return!1;const{state:t}=e,{selection:n,doc:s}=t,{$from:r,empty:i}=n;if(!i||r.parent.type!==this.type||!(r.parentOffset===r.parent.nodeSize-2))return!1;const a=r.after();return a===void 0||s.nodeAt(a)?!1:e.commands.exitCode()}}},addInputRules(){return[ft({find:Ks,type:this.type,getAttributes:e=>({language:e[1]})}),ft({find:zs,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new P({key:new B("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData||this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),s=t.clipboardData.getData("vscode-editor-data"),r=s?JSON.parse(s):void 0,i=r?.mode;if(!n||!i)return!1;const{tr:o}=e.state;return o.replaceSelectionWith(this.type.create({language:i})),o.setSelection(L.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.insertText(n.replace(/\r\n?/g,`
`)),o.setMeta("paste",!0),e.dispatch(o),!0}}})]}}),Ws=E.create({name:"doc",topNode:!0,content:"block+"}),qs=A.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[re(this.options)]}}),Us=A.create({name:"gapCursor",addProseMirrorPlugins(){return[oe()]},extendNodeSchema(e){var t;const n={name:e.name,options:e.options,storage:e.storage};return{allowGapCursor:(t=k(y(e,"allowGapCursor",n)))!==null&&t!==void 0?t:null}}}),Gs=E.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:e}){return["br",S(this.options.HTMLAttributes,e)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:e,chain:t,state:n,editor:s})=>e.first([()=>e.exitCode(),()=>e.command(()=>{const{selection:r,storedMarks:i}=n;if(r.$from.parent.type.spec.isolating)return!1;const{keepMarks:o}=this.options,{splittableMarks:a}=s.extensionManager,c=i||r.$to.parentOffset&&r.$from.marks();return t().insertContent({type:this.name}).command(({tr:d,dispatch:p})=>{if(p&&c&&o){const l=c.filter(u=>a.includes(u.type.name));d.ensureMarks(l)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),Js=E.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return[`h${this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]}`,S(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.setNode(this.name,e):!1,toggleHeading:e=>({commands:t})=>this.options.levels.includes(e.level)?t.toggleNode(this.name,"paragraph",e):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>ft({find:new RegExp(`^(#{1,${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}}),Zs=A.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:e,dispatch:t})=>ie(e,t),redo:()=>({state:e,dispatch:t})=>ae(e,t)}},addProseMirrorPlugins(){return[ce(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-Z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-Y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Shift-Mod-Z":()=>this.editor.commands.redo(),"Mod-\u044F":()=>this.editor.commands.undo(),"Shift-Mod-\u044F":()=>this.editor.commands.redo()}}}),Ys=E.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:e}){return["hr",S(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e,state:t})=>{const{$to:n}=t.selection,s=e();return n.parentOffset===0?s.insertContentAt(Math.max(n.pos-2,0),{type:this.name}):s.insertContent({type:this.name}),s.command(({tr:r,dispatch:i})=>{var o;if(i){const{$to:a}=r.selection,c=a.end();if(a.nodeAfter)a.nodeAfter.isTextblock?r.setSelection(L.create(r.doc,a.pos+1)):a.nodeAfter.isBlock?r.setSelection(J.create(r.doc,a.pos)):r.setSelection(L.create(r.doc,a.pos));else{const d=(o=a.parent.type.contentMatch.defaultType)===null||o===void 0?void 0:o.create();d&&(r.insert(c,d),r.setSelection(L.create(r.doc,c+1)))}r.scrollIntoView()}return!0}).run()}}},addInputRules(){return[As({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),Qs=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,Xs=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,tr=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,er=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,nr=H.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",S(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[_({find:Qs,type:this.type}),_({find:tr,type:this.type})]},addPasteRules(){return[D({find:Xs,type:this.type}),D({find:er,type:this.type})]}}),sr=E.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",S(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),rr=E.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",S(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Bt=H.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",S(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const n=st(e,this.type);return Object.entries(n).some(([,r])=>!!r)?!0:t.unsetMark(this.name)}}}}),It=/^(\d+)\.\s$/,or=E.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return t===1?["ol",S(this.options.HTMLAttributes,n),0]:["ol",S(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(rr.name,this.editor.getAttributes(Bt.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=K({find:It,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=K({find:It,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(Bt.name)}),joinPredicate:(t,n)=>n.childCount+n.attrs.start===+t[1],editor:this.editor})),[e]}}),ir=E.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:e}){return["p",S(this.options.HTMLAttributes,e),0]},addCommands(){return{setParagraph:()=>({commands:e})=>e.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),ar=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,cr=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,dr=H.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",S(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){const e={};return Mt()?e["Mod-Shift-s"]=()=>this.editor.commands.toggleStrike():e["Ctrl-Shift-s"]=()=>this.editor.commands.toggleStrike(),e},addInputRules(){return[_({find:ar,type:this.type})]},addPasteRules(){return[D({find:cr,type:this.type})]}}),lr=E.create({name:"text",group:"inline"}),xr=A.create({name:"starterKit",addExtensions(){var e,t,n,s,r,i,o,a,c,d,p,l,u,f,h,m,g,b;const v=[];return this.options.blockquote!==!1&&v.push(Hs.configure((e=this.options)===null||e===void 0?void 0:e.blockquote)),this.options.bold!==!1&&v.push(Ns.configure((t=this.options)===null||t===void 0?void 0:t.bold)),this.options.bulletList!==!1&&v.push(js.configure((n=this.options)===null||n===void 0?void 0:n.bulletList)),this.options.code!==!1&&v.push(Fs.configure((s=this.options)===null||s===void 0?void 0:s.code)),this.options.codeBlock!==!1&&v.push(Vs.configure((r=this.options)===null||r===void 0?void 0:r.codeBlock)),this.options.document!==!1&&v.push(Ws.configure((i=this.options)===null||i===void 0?void 0:i.document)),this.options.dropcursor!==!1&&v.push(qs.configure((o=this.options)===null||o===void 0?void 0:o.dropcursor)),this.options.gapcursor!==!1&&v.push(Us.configure((a=this.options)===null||a===void 0?void 0:a.gapcursor)),this.options.hardBreak!==!1&&v.push(Gs.configure((c=this.options)===null||c===void 0?void 0:c.hardBreak)),this.options.heading!==!1&&v.push(Js.configure((d=this.options)===null||d===void 0?void 0:d.heading)),this.options.history!==!1&&v.push(Zs.configure((p=this.options)===null||p===void 0?void 0:p.history)),this.options.horizontalRule!==!1&&v.push(Ys.configure((l=this.options)===null||l===void 0?void 0:l.horizontalRule)),this.options.italic!==!1&&v.push(nr.configure((u=this.options)===null||u===void 0?void 0:u.italic)),this.options.listItem!==!1&&v.push(sr.configure((f=this.options)===null||f===void 0?void 0:f.listItem)),this.options.orderedList!==!1&&v.push(or.configure((h=this.options)===null||h===void 0?void 0:h.orderedList)),this.options.paragraph!==!1&&v.push(ir.configure((m=this.options)===null||m===void 0?void 0:m.paragraph)),this.options.strike!==!1&&v.push(dr.configure((g=this.options)===null||g===void 0?void 0:g.strike)),this.options.text!==!1&&v.push(lr.configure((b=this.options)===null||b===void 0?void 0:b.text)),v}}),Ar=A.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>e.style.textAlign||this.options.defaultAlignment,renderHTML:e=>e.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${e.textAlign}`}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.every(n=>t.updateAttributes(n,{textAlign:e})):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.every(t=>e.resetAttributes(t,"textAlign"))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});export{Sr as E,xr as S,Ar as T,Tr as u};
