/*!
 * maska v1.5.2
 * (c) 2019-2022 Alexander Shabunevich
 * Released under the MIT License.
 */function h(n,r){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);r&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(n,a).enumerable})),e.push.apply(e,t)}return e}function v(n){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?h(Object(e),!0).forEach(function(t){S(n,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(e)):h(Object(e)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(e,t))})}return n}function E(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}function j(n,r){for(var e=0;e<r.length;e++){var t=r[e];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(n,b(t.key),t)}}function S(n,r,e){return(r=b(r))in n?Object.defineProperty(n,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[r]=e,n}function b(n){var r=function(e,t){if(typeof e!="object"||e===null)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var o=a.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}(n,"string");return typeof r=="symbol"?r:String(r)}var w={"#":{pattern:/[0-9]/},X:{pattern:/[0-9a-zA-Z]/},S:{pattern:/[a-zA-Z]/},A:{pattern:/[a-zA-Z]/,uppercase:!0},a:{pattern:/[a-zA-Z]/,lowercase:!0},"!":{escape:!0},"*":{repeat:!0}};function k(n,r){var e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:w,t=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];return O(r).length>1?A(r)(n,r,e,t):g(n,r,e,t)}function O(n){try{return JSON.parse(n)}catch{return[n]}}function A(n){var r=O(n).sort(function(t,a){return t.length-a.length});return function(t,a,o){var u=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],s=r.map(function(i){return g(t,i,o,!1)}),p=s.pop();for(var l in r)if(e(p,r[l],o))return g(t,r[l],o,u);return""};function e(t,a,o){for(var u in o)o[u].escape&&(a=a.replace(new RegExp(u+".{1}","g"),""));return a.split("").filter(function(s){return o[s]&&o[s].pattern}).length>=t.length}}function g(n,r,e){for(var t=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3],a=0,o=0,u="",s="";a<r.length&&o<n.length;){var p=r[a],l=n[o],i=e[p];if(i&&i.pattern)i.pattern.test(l)&&(u+=P(l,i),a++,t&&r[a]&&(e[r[a]]?e[r[a]]&&e[r[a]].escape&&(u+=r[a+1],a+=2):(u+=r[a],a++))),o++;else if(i&&i.repeat){var c=e[r[a-1]];c&&!c.pattern.test(l)?a++:a--}else i&&i.escape&&(p=r[++a]),t&&(u+=p),l===p&&o++,a++}for(;t&&a<r.length;){var f=r[a];if(e[f]){s="";break}s+=f,a++}return u+s}function P(n,r){return r.transform&&(n=r.transform(n)),r.uppercase?n.toLocaleUpperCase():r.lowercase?n.toLocaleLowerCase():n}function y(n){return n instanceof HTMLInputElement?n:n.querySelector("input")||n}function d(n){return Object.prototype.toString.call(n)==="[object String]"}var V=function(){function n(t){var a=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(E(this,n),!t)throw new Error("Maska: no element for mask");if(o.preprocessor!=null&&typeof o.preprocessor!="function")throw new Error("Maska: preprocessor must be a function");if(o.tokens)for(var u in o.tokens)o.tokens[u]=v({},o.tokens[u]),o.tokens[u].pattern&&d(o.tokens[u].pattern)&&(o.tokens[u].pattern=new RegExp(o.tokens[u].pattern));this._opts={mask:o.mask,tokens:v(v({},w),o.tokens),preprocessor:o.preprocessor},this._el=d(t)?document.querySelectorAll(t):t.length?t:[t],this.inputEvent=function(s){return a.updateValue(s.target,s)},this.init()}var r,e;return r=n,e=[{key:"init",value:function(){for(var t=this,a=function(u){var s=y(t._el[u]);!t._opts.mask||s.dataset.mask&&s.dataset.mask===t._opts.mask||(s.dataset.mask=t._opts.mask),setTimeout(function(){return t.updateValue(s)},0),s.dataset.maskInited||(s.dataset.maskInited=!0,s.addEventListener("input",t.inputEvent),s.addEventListener("beforeinput",t.beforeInput))},o=0;o<this._el.length;o++)a(o)}},{key:"destroy",value:function(){for(var t=0;t<this._el.length;t++){var a=y(this._el[t]);a.removeEventListener("input",this.inputEvent),a.removeEventListener("beforeinput",this.beforeInput),delete a.dataset.mask,delete a.dataset.maskInited}}},{key:"updateValue",value:function(t,a){if(t&&t.type){var o=t.type.match(/^number$/i)&&t.validity.badInput;if(!t.value&&!o||!t.dataset.mask)return t.dataset.maskRawValue="",void this.dispatch("maska",t,a);var u=t.selectionEnd,s=t.value,p=s[u-1];t.dataset.maskRawValue=k(t.value,t.dataset.mask,this._opts.tokens,!1);var l=t.value;this._opts.preprocessor&&(l=this._opts.preprocessor(l)),t.value=k(l,t.dataset.mask,this._opts.tokens),a&&a.inputType==="insertText"&&u===s.length&&(u=t.value.length),function(i,c,f){for(;c&&c<i.value.length&&i.value.charAt(c-1)!==f;)c++;(i.type?i.type.match(/^(text|search|password|tel|url)$/i):!i.type)&&i===document.activeElement&&(i.setSelectionRange(c,c),setTimeout(function(){i.setSelectionRange(c,c)},0))}(t,u,p),this.dispatch("maska",t,a),t.value!==s&&this.dispatch("input",t,a)}}},{key:"beforeInput",value:function(t){t&&t.target&&t.target.type&&t.target.type.match(/^number$/i)&&t.data&&isNaN(t.target.value+t.data)&&t.preventDefault()}},{key:"dispatch",value:function(t,a,o){a.dispatchEvent(function(u){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,p=document.createEvent("Event");return p.initEvent(u,!0,!0),s&&(p.inputType=s),p}(t,o&&o.inputType||null))}}],e&&j(r.prototype,e),Object.defineProperty(r,"prototype",{writable:!1}),n}(),m,_=(m=new WeakMap,function(n,r){r.value&&(m.has(n)&&!function(e){return!(d(e.value)&&e.value===e.oldValue||Array.isArray(e.value)&&JSON.stringify(e.value)===JSON.stringify(e.oldValue)||e.value&&e.value.mask&&e.oldValue&&e.oldValue.mask&&e.value.mask===e.oldValue.mask)}(r)||m.set(n,new V(n,function(e){var t={};return e.mask?(t.mask=Array.isArray(e.mask)?JSON.stringify(e.mask):e.mask,t.tokens=e.tokens?v({},e.tokens):{},t.preprocessor=e.preprocessor):t.mask=Array.isArray(e)?JSON.stringify(e):e,t}(r.value))))});function T(n){n.directive("maska",_)}typeof window<"u"&&window.Vue&&window.Vue.use&&window.Vue.use(T);export{T as k};
