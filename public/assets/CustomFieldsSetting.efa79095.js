import{v as z}from"./vue-i18n.c6de3223.js";import{j as ae,u as re,m as H,e as Q,c as G,g as P,o as g}from"./main.f5ac513d.js";import{u as ne}from"./vue-router.746ec05f.js";import{i as Z,O as i,j as v,k as F,U as r,l,u as t,as as D,X as T,R as A,r as U,M as N,S as ue,by as ee,f as J,a as B,at as ie,P as O,z as de,F as me,aW as ce,g as j,aX as pe,aq as _e}from"./@vue.8cc12e6e.js";import"./moment.9709ab41.js";import{c as q,r as M,n as fe,d as ve}from"./@vuelidate.c7422de1.js";import"./@intlify.0be1c2d8.js";import"./vue.a6ed3e81.js";import"./v-tooltip.1cd7a91e.js";import"./vue-resize.0b8cd4b5.js";import"./@popperjs.940d197a.js";import"./axios.7b768d2b.js";import"./pinia.32c02ade.js";import"./lodash.8ab3583e.js";import"./guid.7b3dea7e.js";import"./@headlessui.4523e0e1.js";import"./@vueuse.b6c5a1c1.js";import"./prettier.6e0a0647.js";import"./vue-flatpickr-component.30399bbe.js";import"./flatpickr.dff0933c.js";import"./@heroicons.aa650707.js";import"./v-money3.6f830de1.js";import"./maska.1121c2e3.js";const ye={__name:"CustomFieldIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(w){const c=w,e=ae();re();const{t:u}=z.useI18n(),f=H();ne();const p=Q(),d=G();Z("utils");async function m(C){await f.fetchCustomField(C),d.openModal({title:u("settings.custom_fields.edit_custom_field"),componentName:"CustomFieldModal",size:"sm",data:C,refreshData:c.loadData})}async function S(C){e.openDialog({title:u("general.are_you_sure"),message:u("settings.custom_fields.custom_field_confirm_delete"),yesLabel:u("general.ok"),noLabel:u("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async b=>{b&&(await f.deleteCustomFields(C),c.loadData&&c.loadData())})}return(C,b)=>{const _=i("BaseIcon"),V=i("BaseDropdownItem"),I=i("BaseDropdown");return v(),F(I,null,{activator:r(()=>[l(_,{name:"DotsHorizontalIcon",class:"h-5 text-gray-500"})]),default:r(()=>[t(p).hasAbilities(t(P).EDIT_CUSTOM_FIELDS)?(v(),F(V,{key:0,onClick:b[0]||(b[0]=s=>m(w.row.id))},{default:r(()=>[l(_,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),D(" "+T(C.$t("general.edit")),1)]),_:1})):A("",!0),t(p).hasAbilities(t(P).DELETE_CUSTOM_FIELDS)?(v(),F(V,{key:1,onClick:b[1]||(b[1]=s=>S(w.row.id))},{default:r(()=>[l(_,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),D(" "+T(C.$t("general.delete")),1)]),_:1})):A("",!0)]),_:1})}}},Ce={class:"flex items-center mt-1"},be={__name:"OptionsCreate",emits:["onAdd"],setup(w,{emit:c}){const e=U(null);function u(){if(e.value==null||e.value==""||e.value==null)return!0;c("onAdd",e.value),e.value=null}return(f,p)=>{const d=i("BaseInput"),m=i("BaseIcon");return v(),N("div",Ce,[l(d,{modelValue:e.value,"onUpdate:modelValue":p[0]||(p[0]=S=>e.value=S),type:"text",class:"w-full md:w-96",placeholder:f.$t("settings.custom_fields.press_enter_to_add"),onClick:u,onKeydown:ue(ee(u,["prevent","stop"]),["enter"])},null,8,["modelValue","placeholder","onKeydown"]),l(m,{name:"PlusCircleIcon",class:"ml-1 text-primary-500 cursor-pointer",onClick:u})])}}};function ge(w){switch(w){case"../../custom-fields/types/DateTimeType.vue":return g(()=>import("./DateTimeType.e83500fb.js"),["assets/DateTimeType.e83500fb.js","assets/moment.9709ab41.js","assets/@vue.8cc12e6e.js"]);case"../../custom-fields/types/DateType.vue":return g(()=>import("./DateType.3f6fd59f.js"),["assets/DateType.3f6fd59f.js","assets/moment.9709ab41.js","assets/@vue.8cc12e6e.js"]);case"../../custom-fields/types/DropdownType.vue":return g(()=>import("./DropdownType.1b318c1f.js"),["assets/DropdownType.1b318c1f.js","assets/@vue.8cc12e6e.js"]);case"../../custom-fields/types/InputType.vue":return g(()=>import("./InputType.0c6f6072.js"),["assets/InputType.0c6f6072.js","assets/@vue.8cc12e6e.js"]);case"../../custom-fields/types/NumberType.vue":return g(()=>import("./NumberType.0de04a7b.js"),["assets/NumberType.0de04a7b.js","assets/@vue.8cc12e6e.js"]);case"../../custom-fields/types/PhoneType.vue":return g(()=>import("./PhoneType.8d3a0ec1.js"),["assets/PhoneType.8d3a0ec1.js","assets/@vue.8cc12e6e.js"]);case"../../custom-fields/types/SwitchType.vue":return g(()=>import("./SwitchType.ccecda4a.js"),["assets/SwitchType.ccecda4a.js","assets/@vue.8cc12e6e.js"]);case"../../custom-fields/types/TextAreaType.vue":return g(()=>import("./TextAreaType.08ac9a7e.js"),["assets/TextAreaType.08ac9a7e.js","assets/@vue.8cc12e6e.js"]);case"../../custom-fields/types/TimeType.vue":return g(()=>import("./TimeType.7885018a.js"),["assets/TimeType.7885018a.js","assets/moment.9709ab41.js","assets/@vue.8cc12e6e.js"]);case"../../custom-fields/types/UrlType.vue":return g(()=>import("./UrlType.6e432763.js"),["assets/UrlType.6e432763.js","assets/@vue.8cc12e6e.js"]);default:return new Promise(function(c,e){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(e.bind(null,new Error("Unknown variable dynamic import: "+w)))})}}const Fe={class:"flex justify-between w-full"},we=["onSubmit"],$e={class:"overflow-y-auto max-h-[550px]"},Te={class:"px-4 md:px-8 py-8 overflow-y-auto sm:p-6"},Ie={class:"z-0 flex justify-end p-4 border-t border-solid border-gray-light border-modal-bg"},Be={__name:"CustomFieldModal",setup(w){const c=G(),e=H(),{t:u}=z.useI18n();let f=U(!1);const p=J(["Customer","Invoice","Estimate","Expense","Payment"]),d=J([{label:"Text",value:"Input"},{label:"Textarea",value:"TextArea"},{label:"Phone",value:"Phone"},{label:"URL",value:"Url"},{label:"Number",value:"Number"},{label:"Select Field",value:"Dropdown"},{label:"Switch Toggle",value:"Switch"},{label:"Date",value:"Date"},{label:"Time",value:"Time"},{label:"Date & Time",value:"DateTime"}]);let m=U(d[0]);const S=B(()=>c.active&&c.componentName==="CustomFieldModal"),C=B(()=>m.value&&m.value.label==="Switch Toggle"),b=B(()=>m.value&&m.value.label==="Select Field"),_=B(()=>e.currentCustomField.type?ie(()=>ge(`../../custom-fields/types/${e.currentCustomField.type}Type.vue`)):!1),V=B({get:()=>e.currentCustomField.is_required===1,set:o=>{const a=o?1:0;e.currentCustomField.is_required=a}}),I=B(()=>({currentCustomField:{type:{required:q.withMessage(u("validation.required"),M)},name:{required:q.withMessage(u("validation.required"),M)},label:{required:q.withMessage(u("validation.required"),M)},model_type:{required:q.withMessage(u("validation.required"),M)},order:{required:q.withMessage(u("validation.required"),M),numeric:q.withMessage(u("validation.numbers_only"),fe)},type:{required:q.withMessage(u("validation.required"),M)}}})),s=ve(I,B(()=>e));function h(){e.isEdit?m.value=d.find(o=>o.value==e.currentCustomField.type):(e.currentCustomField.model_type=p[0],e.currentCustomField.type=d[0].value,m.value=d[0])}async function L(){if(s.value.currentCustomField.$touch(),s.value.currentCustomField.$invalid)return!0;f.value=!0;let o={...e.currentCustomField};if(e.currentCustomField.options&&(o.options=e.currentCustomField.options.map(E=>E.name)),o.type=="Time"&&typeof o.default_answer=="object"){let E=o&&o.default_answer&&o.default_answer.HH?o.default_answer.HH:null,k=o&&o.default_answer&&o.default_answer.mm?o.default_answer.mm:null;o&&o.default_answer&&o.default_answer.ss&&o.default_answer.ss,o.default_answer=`${E}:${k}`}await(e.isEdit?e.updateCustomField:e.addCustomField)(o),f.value=!1,c.refreshData&&c.refreshData(),R()}function x(o){e.currentCustomField.options=[{name:o},...e.currentCustomField.options]}function y(o){if(e.isEdit&&e.currentCustomField.in_use)return;e.currentCustomField.options[o].name===e.currentCustomField.default_answer&&(e.currentCustomField.default_answer=null),e.currentCustomField.options.splice(o,1)}function te(o){e.currentCustomField.type=o.value}function R(){c.closeModal(),setTimeout(()=>{e.resetCurrentCustomField(),s.value.$reset()},300)}return(o,a)=>{const E=i("BaseIcon"),k=i("BaseInput"),$=i("BaseInputGroup"),K=i("BaseMultiselect"),oe=i("BaseSwitch"),le=i("BaseInputGrid"),X=i("BaseButton"),se=i("BaseModal");return v(),F(se,{show:S.value,onOpen:h},{header:r(()=>[O("div",Fe,[D(T(t(c).title)+" ",1),l(E,{name:"XIcon",class:"w-6 h-6 text-gray-500 cursor-pointer",onClick:R})])]),default:r(()=>[O("form",{action:"",onSubmit:ee(L,["prevent"])},[O("div",$e,[O("div",Te,[l(le,{layout:"one-column"},{default:r(()=>[l($,{label:o.$t("settings.custom_fields.name"),required:"",error:t(s).currentCustomField.name.$error&&t(s).currentCustomField.name.$errors[0].$message},{default:r(()=>[l(k,{ref:"name",modelValue:t(e).currentCustomField.name,"onUpdate:modelValue":a[0]||(a[0]=n=>t(e).currentCustomField.name=n),invalid:t(s).currentCustomField.name.$error,onInput:a[1]||(a[1]=n=>t(s).currentCustomField.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),l($,{label:o.$t("settings.custom_fields.model"),error:t(s).currentCustomField.model_type.$error&&t(s).currentCustomField.model_type.$errors[0].$message,"help-text":t(e).currentCustomField.in_use?o.$t("settings.custom_fields.model_in_use"):"",required:""},{default:r(()=>[l(K,{modelValue:t(e).currentCustomField.model_type,"onUpdate:modelValue":a[2]||(a[2]=n=>t(e).currentCustomField.model_type=n),options:p,"can-deselect":!1,invalid:t(s).currentCustomField.model_type.$error,searchable:!0,disabled:t(e).currentCustomField.in_use,onInput:a[3]||(a[3]=n=>t(s).currentCustomField.model_type.$touch())},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),l($,{class:"flex items-center space-x-4",label:o.$t("settings.custom_fields.required")},{default:r(()=>[l(oe,{modelValue:V.value,"onUpdate:modelValue":a[4]||(a[4]=n=>V.value=n)},null,8,["modelValue"])]),_:1},8,["label"]),l($,{label:o.$t("settings.custom_fields.type"),error:t(s).currentCustomField.type.$error&&t(s).currentCustomField.type.$errors[0].$message,"help-text":t(e).currentCustomField.in_use?o.$t("settings.custom_fields.type_in_use"):"",required:""},{default:r(()=>[l(K,{modelValue:t(m),"onUpdate:modelValue":[a[5]||(a[5]=n=>de(m)?m.value=n:m=n),te],options:d,invalid:t(s).currentCustomField.type.$error,disabled:t(e).currentCustomField.in_use,searchable:!0,"can-deselect":!1,object:""},null,8,["modelValue","options","invalid","disabled"])]),_:1},8,["label","error","help-text"]),l($,{label:o.$t("settings.custom_fields.label"),required:"",error:t(s).currentCustomField.label.$error&&t(s).currentCustomField.label.$errors[0].$message},{default:r(()=>[l(k,{modelValue:t(e).currentCustomField.label,"onUpdate:modelValue":a[6]||(a[6]=n=>t(e).currentCustomField.label=n),invalid:t(s).currentCustomField.label.$error,onInput:a[7]||(a[7]=n=>t(s).currentCustomField.label.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),b.value?(v(),F($,{key:0,label:o.$t("settings.custom_fields.options")},{default:r(()=>[l(be,{onOnAdd:x}),(v(!0),N(me,null,ce(t(e).currentCustomField.options,(n,Y)=>(v(),N("div",{key:Y,class:"flex items-center mt-5"},[l(k,{modelValue:n.name,"onUpdate:modelValue":W=>n.name=W,class:"w-64"},null,8,["modelValue","onUpdate:modelValue"]),l(E,{name:"MinusCircleIcon",class:j(["ml-1 cursor-pointer",t(e).currentCustomField.in_use?"text-gray-300":"text-red-300"]),onClick:W=>y(Y)},null,8,["class","onClick"])]))),128))]),_:1},8,["label"])):A("",!0),l($,{label:o.$t("settings.custom_fields.default_value"),class:"relative"},{default:r(()=>[(v(),F(pe(_.value),{modelValue:t(e).currentCustomField.default_answer,"onUpdate:modelValue":a[8]||(a[8]=n=>t(e).currentCustomField.default_answer=n),options:t(e).currentCustomField.options,"default-date-time":t(e).currentCustomField.dateTimeValue},null,8,["modelValue","options","default-date-time"]))]),_:1},8,["label"]),C.value?A("",!0):(v(),F($,{key:1,label:o.$t("settings.custom_fields.placeholder")},{default:r(()=>[l(k,{modelValue:t(e).currentCustomField.placeholder,"onUpdate:modelValue":a[9]||(a[9]=n=>t(e).currentCustomField.placeholder=n)},null,8,["modelValue"])]),_:1},8,["label"])),l($,{label:o.$t("settings.custom_fields.order"),error:t(s).currentCustomField.order.$error&&t(s).currentCustomField.order.$errors[0].$message,required:""},{default:r(()=>[l(k,{modelValue:t(e).currentCustomField.order,"onUpdate:modelValue":a[10]||(a[10]=n=>t(e).currentCustomField.order=n),type:"number",invalid:t(s).currentCustomField.order.$error,onInput:a[11]||(a[11]=n=>t(s).currentCustomField.order.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})])]),O("div",Ie,[l(X,{class:"mr-3",type:"button",variant:"primary-outline",onClick:R},{default:r(()=>[D(T(o.$t("general.cancel")),1)]),_:1}),l(X,{variant:"primary",loading:t(f),disabled:t(f),type:"submit"},{left:r(n=>[t(f)?A("",!0):(v(),F(E,{key:0,class:j(n.class),name:"SaveIcon"},null,8,["class"]))]),default:r(()=>[D(" "+T(t(e).isEdit?o.$t("general.update"):o.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,we)]),_:1},8,["show"])}}},De={class:"text-xs text-gray-500"},Je={__name:"CustomFieldsSetting",setup(w){const c=G(),e=H(),u=Q(),f=Z("utils"),{t:p}=z.useI18n(),d=U(null),m=B(()=>[{key:"name",label:p("settings.custom_fields.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"model_type",label:p("settings.custom_fields.model")},{key:"type",label:p("settings.custom_fields.type")},{key:"is_required",label:p("settings.custom_fields.required")},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]);async function S({page:_,filter:V,sort:I}){let s={orderByField:I.fieldName||"created_at",orderBy:I.order||"desc",page:_},h=await e.fetchCustomFields(s);return{data:h.data.data,pagination:{totalPages:h.data.meta.last_page,currentPage:_,limit:5,totalCount:h.data.meta.total}}}function C(){c.openModal({title:p("settings.custom_fields.add_custom_field"),componentName:"CustomFieldModal",size:"sm",refreshData:d.value&&d.value.refresh})}async function b(){d.value&&d.value.refresh()}return(_,V)=>{const I=i("BaseIcon"),s=i("BaseButton"),h=i("BaseBadge"),L=i("BaseTable"),x=i("BaseSettingCard");return v(),F(x,{title:_.$t("settings.menu_title.custom_fields"),description:_.$t("settings.custom_fields.section_description")},{action:r(()=>[t(u).hasAbilities(t(P).CREATE_CUSTOM_FIELDS)?(v(),F(s,{key:0,variant:"primary-outline",onClick:C},{left:r(y=>[l(I,{class:j(y.class),name:"PlusIcon"},null,8,["class"]),D(" "+T(_.$t("settings.custom_fields.add_custom_field")),1)]),_:1})):A("",!0)]),default:r(()=>[l(Be),l(L,{ref_key:"table",ref:d,data:S,columns:m.value,class:"mt-16"},_e({"cell-name":r(({row:y})=>[D(T(y.data.name)+" ",1),O("span",De," ("+T(y.data.slug)+")",1)]),"cell-is_required":r(({row:y})=>[l(h,{"bg-color":t(f).getBadgeStatusColor(y.data.is_required?"YES":"NO").bgColor,color:t(f).getBadgeStatusColor(y.data.is_required?"YES":"NO").color},{default:r(()=>[D(T(y.data.is_required?_.$t("settings.custom_fields.yes"):_.$t("settings.custom_fields.no").replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),_:2},[t(u).hasAbilities([t(P).DELETE_CUSTOM_FIELDS,t(P).EDIT_CUSTOM_FIELDS])?{name:"cell-actions",fn:r(({row:y})=>[l(ye,{row:y.data,table:d.value,"load-data":b},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"])]),_:1},8,["title","description"])}}};export{Je as default};
