import{r as v,f as se,a as C,b as oe,O as l,j as p,k as _,U as t,l as a,P as i,L as D,bx as T,u as n,g as b,as as y,X as d,R as F,aq as le}from"./@vue.8cc12e6e.js";import{h as ne}from"./moment.9709ab41.js";import{v as re}from"./vue-i18n.c6de3223.js";import{b as me,j as ue,l as ce,e as ie,g as B}from"./main.f5ac513d.js";import{_ as de}from"./CustomerIndexDropdown.89da222a.js";import{_ as pe}from"./AstronautIcon.ce8aac52.js";import{d as _e}from"./@vueuse.b6c5a1c1.js";import"./@intlify.0be1c2d8.js";import"./vue.a6ed3e81.js";import"./v-tooltip.1cd7a91e.js";import"./vue-resize.0b8cd4b5.js";import"./@popperjs.940d197a.js";import"./axios.7b768d2b.js";import"./vue-router.746ec05f.js";import"./pinia.32c02ade.js";import"./lodash.8ab3583e.js";import"./@vuelidate.c7422de1.js";import"./guid.7b3dea7e.js";import"./@headlessui.4523e0e1.js";import"./prettier.6e0a0647.js";import"./vue-flatpickr-component.30399bbe.js";import"./flatpickr.dff0933c.js";import"./@heroicons.aa650707.js";import"./v-money3.6f830de1.js";import"./maska.1121c2e3.js";const fe={class:"flex items-center justify-end space-x-5"},he={class:"relative table-container"},ye={class:"relative flex items-center justify-end h-5"},Be={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},ve={class:"absolute z-10 items-center left-6 top-2.5 select-none"},Ce={class:"relative block"},He={__name:"Index",setup(be){me();const N=ue(),m=ce(),g=ie();let k=v(null),f=v(!1),x=v(!0);const{t:c}=re.useI18n();let r=se({display_name:"",contact_name:"",phone:""});const w=C(()=>!m.totalCustomers&&!x.value),A=C({get:()=>m.selectedCustomers,set:s=>m.selectCustomer(s)}),U=C({get:()=>m.selectAllField,set:s=>m.setSelectAllState(s)}),j=C(()=>[{key:"status",thClass:"extra w-10 pr-0",sortable:!1,tdClass:"font-medium text-gray-900 pr-0"},{key:"name",label:c("customers.name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"phone",label:c("customers.phone")},{key:"due_amount",label:c("customers.amount_due")},{key:"created_at",label:c("items.added_on")},{key:"actions",tdClass:"text-right text-sm font-medium pl-0",thClass:"pl-0",sortable:!1}]);_e(r,()=>{L()},{debounce:500}),oe(()=>{m.selectAllField&&m.selectAllCustomers()});function I(){k.value.refresh()}function L(){I()}function W(){return g.hasAbilities([B.DELETE_CUSTOMER,B.EDIT_CUSTOMER,B.VIEW_CUSTOMER])}async function Y({page:s,filter:o,sort:h}){let V={display_name:r.display_name,contact_name:r.contact_name,phone:r.phone,orderByField:h.fieldName||"created_at",orderBy:h.order||"desc",page:s};x.value=!0;let u=await m.fetchCustomers(V);return x.value=!1,{data:u.data.data,pagination:{totalPages:u.data.meta.last_page,currentPage:s,totalCount:u.data.meta.total,limit:10}}}function M(){r.display_name="",r.contact_name="",r.phone=""}function z(){f.value&&M(),f.value=!f.value}let P=v(new Date);P.value=ne(P).format("YYYY-MM-DD");function G(){N.openDialog({title:c("general.are_you_sure"),message:c("customers.confirm_delete",2),yesLabel:c("general.ok"),noLabel:c("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(s=>{s&&m.deleteMultipleCustomers().then(o=>{o.data&&I()})})}return(s,o)=>{const h=l("BaseBreadcrumbItem"),V=l("BaseBreadcrumb"),u=l("BaseIcon"),$=l("BaseButton"),H=l("BasePageHeader"),S=l("BaseInput"),E=l("BaseInputGroup"),X=l("BaseFilterWrapper"),q=l("BaseEmptyPlaceholder"),J=l("BaseDropdownItem"),K=l("BaseDropdown"),R=l("BaseCheckbox"),O=l("BaseText"),Q=l("router-link"),Z=l("BaseFormatMoney"),ee=l("BaseTable"),te=l("BasePage");return p(),_(te,null,{default:t(()=>[a(H,{title:s.$t("customers.title")},{actions:t(()=>[i("div",fe,[D(a($,{variant:"primary-outline",onClick:z},{right:t(e=>[n(f)?(p(),_(u,{key:1,name:"XIcon",class:b(e.class)},null,8,["class"])):(p(),_(u,{key:0,name:"FilterIcon",class:b(e.class)},null,8,["class"]))]),default:t(()=>[y(d(s.$t("general.filter"))+" ",1)]),_:1},512),[[T,n(m).totalCustomers]]),n(g).hasAbilities(n(B).CREATE_CUSTOMER)?(p(),_($,{key:0,onClick:o[0]||(o[0]=e=>s.$router.push("customers/create"))},{left:t(e=>[a(u,{name:"PlusIcon",class:b(e.class)},null,8,["class"])]),default:t(()=>[y(" "+d(s.$t("customers.new_customer")),1)]),_:1})):F("",!0)])]),default:t(()=>[a(V,null,{default:t(()=>[a(h,{title:s.$t("general.home"),to:"dashboard"},null,8,["title"]),a(h,{title:s.$tc("customers.customer",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),a(X,{show:n(f),class:"mt-5",onClear:M},{default:t(()=>[a(E,{label:s.$t("customers.display_name"),class:"text-left"},{default:t(()=>[a(S,{modelValue:n(r).display_name,"onUpdate:modelValue":o[1]||(o[1]=e=>n(r).display_name=e),type:"text",name:"name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),a(E,{label:s.$t("customers.contact_name"),class:"text-left"},{default:t(()=>[a(S,{modelValue:n(r).contact_name,"onUpdate:modelValue":o[2]||(o[2]=e=>n(r).contact_name=e),type:"text",name:"address_name",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"]),a(E,{label:s.$t("customers.phone"),class:"text-left"},{default:t(()=>[a(S,{modelValue:n(r).phone,"onUpdate:modelValue":o[3]||(o[3]=e=>n(r).phone=e),type:"text",name:"phone",autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["show"]),D(a(q,{title:s.$t("customers.no_customers"),description:s.$t("customers.list_of_customers")},{actions:t(()=>[n(g).hasAbilities(n(B).CREATE_CUSTOMER)?(p(),_($,{key:0,variant:"primary-outline",onClick:o[4]||(o[4]=e=>s.$router.push("/admin/customers/create"))},{left:t(e=>[a(u,{name:"PlusIcon",class:b(e.class)},null,8,["class"])]),default:t(()=>[y(" "+d(s.$t("customers.add_new_customer")),1)]),_:1})):F("",!0)]),default:t(()=>[a(pe,{class:"mt-5 mb-4"})]),_:1},8,["title","description"]),[[T,w.value]]),D(i("div",he,[i("div",ye,[n(m).selectedCustomers.length?(p(),_(K,{key:0},{activator:t(()=>[i("span",Be,[y(d(s.$t("general.actions"))+" ",1),a(u,{name:"ChevronDownIcon"})])]),default:t(()=>[a(J,{onClick:G},{default:t(()=>[a(u,{name:"TrashIcon",class:"mr-3 text-gray-600"}),y(" "+d(s.$t("general.delete")),1)]),_:1})]),_:1})):F("",!0)]),a(ee,{ref_key:"tableComponent",ref:k,class:"mt-3",data:Y,columns:j.value},le({header:t(()=>[i("div",ve,[a(R,{modelValue:U.value,"onUpdate:modelValue":o[5]||(o[5]=e=>U.value=e),variant:"primary",onChange:n(m).selectAllCustomers},null,8,["modelValue","onChange"])])]),"cell-status":t(({row:e})=>[i("div",Ce,[a(R,{id:e.data.id,modelValue:A.value,"onUpdate:modelValue":o[6]||(o[6]=ae=>A.value=ae),value:e.data.id,variant:"primary"},null,8,["id","modelValue","value"])])]),"cell-name":t(({row:e})=>[a(Q,{to:{path:`customers/${e.data.id}/view`}},{default:t(()=>[a(O,{text:e.data.name,length:30,tag:"span",class:"font-medium text-primary-500 flex flex-col"},null,8,["text"]),a(O,{text:e.data.contact_name?e.data.contact_name:"",length:30,tag:"span",class:"text-xs text-gray-400"},null,8,["text"])]),_:2},1032,["to"])]),"cell-phone":t(({row:e})=>[i("span",null,d(e.data.phone?e.data.phone:"-"),1)]),"cell-due_amount":t(({row:e})=>[a(Z,{amount:e.data.due_amount||0,currency:e.data.currency},null,8,["amount","currency"])]),"cell-created_at":t(({row:e})=>[i("span",null,d(e.data.formatted_created_at),1)]),_:2},[W()?{name:"cell-actions",fn:t(({row:e})=>[a(de,{row:e.data,table:n(k),"load-data":I},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"])],512),[[T,!w.value]])]),_:1})}}};export{He as default};
