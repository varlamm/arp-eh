import{i as _e,r as y,f as ve,a as P,b as fe,O as n,j as b,k as g,U as l,l as t,L as V,bx as D,u as r,g as h,as as m,X as p,R as F,aq as j,P as f}from"./@vue.8cc12e6e.js";import{b as be}from"./vue-router.746ec05f.js";import{v as ge}from"./vue-i18n.c6de3223.js";import{i as Be,j as Ie,u as ye,e as he,g as v}from"./main.f5ac513d.js";import{_ as ke}from"./MoonwalkerIcon.02070a25.js";import{_ as Ee}from"./InvoiceIndexDropdown.86fb0c41.js";import{_ as Ce}from"./SendInvoiceModal.b7b34c34.js";import{d as Ve}from"./@vueuse.b6c5a1c1.js";import"./@intlify.0be1c2d8.js";import"./vue.a6ed3e81.js";import"./v-tooltip.1cd7a91e.js";import"./vue-resize.0b8cd4b5.js";import"./@popperjs.940d197a.js";import"./axios.7b768d2b.js";import"./pinia.32c02ade.js";import"./lodash.8ab3583e.js";import"./@vuelidate.c7422de1.js";import"./moment.9709ab41.js";import"./guid.7b3dea7e.js";import"./@headlessui.4523e0e1.js";import"./prettier.6e0a0647.js";import"./vue-flatpickr-component.30399bbe.js";import"./flatpickr.dff0933c.js";import"./@heroicons.aa650707.js";import"./v-money3.6f830de1.js";import"./maska.1121c2e3.js";import"./mail-driver.f62a08cc.js";const De=f("div",{class:"hidden w-8 h-0 mx-4 border border-gray-400 border-solid xl:block",style:{"margin-top":"1.5rem"}},null,-1),Te={class:"relative table-container"},$e={class:"relative flex items-center justify-between h-10 mt-5 list-none border-b-2 border-gray-200 border-solid"},Ae={class:"flex text-sm font-medium cursor-pointer select-none text-primary-400"},Se={class:"absolute items-center left-6 top-2.5 select-none"},Pe={class:"relative block"},Fe={class:"flex justify-between"},rt={__name:"Index",setup(Ne){const c=Be(),W=Ie();ye();const{t:o}=ge.useI18n();_e("$utils");const k=y(null),B=y(!1),G=y([{label:"Status",options:["DRAFT","DUE","SENT","VIEWED","COMPLETED"]},{label:"Paid Status",options:["UNPAID","PAID","PARTIALLY_PAID"]},,]),T=y(!0),u=y("general.draft");be();const E=he();let s=ve({customer_id:"",status:"",from_date:"",to_date:"",invoice_number:""});const N=P(()=>!c.invoiceTotalCount&&!T.value),w=P({get:()=>c.selectedInvoices,set:a=>c.selectInvoice(a)}),H=P(()=>[{key:"checkbox",thClass:"extra w-10",tdClass:"font-medium text-gray-900",placeholderClass:"w-10",sortable:!1},{key:"invoice_date",label:o("invoices.date"),thClass:"extra",tdClass:"font-medium"},{key:"invoice_number",label:o("invoices.number")},{key:"name",label:o("invoices.customer")},{key:"status",label:o("invoices.status")},{key:"due_amount",label:o("dashboard.recent_invoices_card.amount_due")},{key:"total",label:o("invoices.total"),tdClass:"font-medium text-gray-900"},{key:"actions",label:o("invoices.action"),tdClass:"text-right text-sm font-medium",thClass:"text-right",sortable:!1}]);Ve(s,()=>{J()},{debounce:500}),fe(()=>{c.selectAllField&&c.selectAllInvoices()});function q(){return E.hasAbilities([v.DELETE_INVOICE,v.EDIT_INVOICE,v.VIEW_INVOICE,v.SEND_INVOICE])}async function z(a,i){s.status="",$()}function $(){k.value&&k.value.refresh()}async function X({page:a,filter:i,sort:_}){let A={customer_id:s.customer_id,status:s.status,from_date:s.from_date,to_date:s.to_date,invoice_number:s.invoice_number,orderByField:_.fieldName||"created_at",orderBy:_.order||"desc",page:a};T.value=!0;let d=await c.fetchInvoices(A);return T.value=!1,{data:d.data.data,pagination:{totalPages:d.data.meta.last_page,currentPage:a,totalCount:d.data.meta.total,limit:10}}}function Y(a){if(u.value==a.title)return!0;switch(u.value=a.title,a.title){case o("general.draft"):s.status="DRAFT";break;case o("general.sent"):s.status="SENT";break;case o("general.due"):s.status="DUE";break;default:s.status="";break}}function J(){c.$patch(a=>{a.selectedInvoices=[],a.selectAllField=!1}),$()}function U(){s.customer_id="",s.status="",s.from_date="",s.to_date="",s.invoice_number="",u.value=o("general.all")}async function K(){W.openDialog({title:o("general.are_you_sure"),message:o("invoices.confirm_delete"),yesLabel:o("general.ok"),noLabel:o("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async a=>{a&&await c.deleteMultipleInvoices().then(i=>{i.data.success&&($(),c.$patch(_=>{_.selectedInvoices=[],_.selectAllField=!1}))})})}function Q(){B.value&&U(),B.value=!B.value}function Z(a){switch(a){case"DRAFT":u.value=o("general.draft");break;case"SENT":u.value=o("general.sent");break;case"DUE":u.value=o("general.due");break;case"COMPLETED":u.value=o("invoices.completed");break;case"PAID":u.value=o("invoices.paid");break;case"UNPAID":u.value=o("invoices.unpaid");break;case"PARTIALLY_PAID":u.value=o("invoices.partially_paid");break;case"VIEWED":u.value=o("invoices.viewed");break;default:u.value=o("general.all");break}}return(a,i)=>{const _=n("BaseBreadcrumbItem"),A=n("BaseBreadcrumb"),d=n("BaseIcon"),S=n("BaseButton"),O=n("router-link"),ee=n("BasePageHeader"),te=n("BaseCustomerSelectInput"),I=n("BaseInputGroup"),ae=n("BaseMultiselect"),R=n("BaseDatePicker"),le=n("BaseInput"),se=n("BaseFilterWrapper"),oe=n("BaseEmptyPlaceholder"),C=n("BaseTab"),ne=n("BaseTabGroup"),ie=n("BaseDropdownItem"),re=n("BaseDropdown"),x=n("BaseCheckbox"),ce=n("BaseText"),L=n("BaseFormatMoney"),ue=n("BaseInvoiceStatusBadge"),M=n("BasePaidStatusBadge"),de=n("BaseTable"),me=n("BasePage");return b(),g(me,null,{default:l(()=>[t(Ce),t(ee,{title:a.$t("invoices.title")},{actions:l(()=>[V(t(S,{variant:"primary-outline",onClick:Q},{right:l(e=>[B.value?(b(),g(d,{key:1,name:"XIcon",class:h(e.class)},null,8,["class"])):(b(),g(d,{key:0,name:"FilterIcon",class:h(e.class)},null,8,["class"]))]),default:l(()=>[m(p(a.$t("general.filter"))+" ",1)]),_:1},512),[[D,r(c).invoiceTotalCount]]),r(E).hasAbilities(r(v).CREATE_INVOICE)?(b(),g(O,{key:0,to:"invoices/create"},{default:l(()=>[t(S,{variant:"primary",class:"ml-4"},{left:l(e=>[t(d,{name:"PlusIcon",class:h(e.class)},null,8,["class"])]),default:l(()=>[m(" "+p(a.$t("invoices.new_invoice")),1)]),_:1})]),_:1})):F("",!0)]),default:l(()=>[t(A,null,{default:l(()=>[t(_,{title:a.$t("general.home"),to:"dashboard"},null,8,["title"]),t(_,{title:a.$tc("invoices.invoice",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),V(t(se,{"row-on-xl":!0,onClear:U},{default:l(()=>[t(I,{label:a.$tc("customers.customer",1)},{default:l(()=>[t(te,{modelValue:r(s).customer_id,"onUpdate:modelValue":i[0]||(i[0]=e=>r(s).customer_id=e),placeholder:a.$t("customers.type_or_click"),"value-prop":"id",label:"name"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(I,{label:a.$t("invoices.status")},{default:l(()=>[t(ae,{modelValue:r(s).status,"onUpdate:modelValue":[i[1]||(i[1]=e=>r(s).status=e),Z],groups:!0,options:G.value,searchable:"",placeholder:a.$t("general.select_a_status"),onRemove:i[2]||(i[2]=e=>z())},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),t(I,{label:a.$t("general.from")},{default:l(()=>[t(R,{modelValue:r(s).from_date,"onUpdate:modelValue":i[3]||(i[3]=e=>r(s).from_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),De,t(I,{label:a.$t("general.to"),class:"mt-2"},{default:l(()=>[t(R,{modelValue:r(s).to_date,"onUpdate:modelValue":i[4]||(i[4]=e=>r(s).to_date=e),"calendar-button":!0,"calendar-button-icon":"calendar"},null,8,["modelValue"])]),_:1},8,["label"]),t(I,{label:a.$t("invoices.invoice_number")},{default:l(()=>[t(le,{modelValue:r(s).invoice_number,"onUpdate:modelValue":i[5]||(i[5]=e=>r(s).invoice_number=e)},{left:l(e=>[t(d,{name:"HashtagIcon",class:h(e.class)},null,8,["class"])]),_:1},8,["modelValue"])]),_:1},8,["label"])]),_:1},512),[[D,B.value]]),V(t(oe,{title:a.$t("invoices.no_invoices"),description:a.$t("invoices.list_of_invoices")},j({default:l(()=>[t(ke,{class:"mt-5 mb-4"})]),_:2},[r(E).hasAbilities(r(v).CREATE_INVOICE)?{name:"actions",fn:l(()=>[t(S,{variant:"primary-outline",onClick:i[6]||(i[6]=e=>a.$router.push("/admin/invoices/create"))},{left:l(e=>[t(d,{name:"PlusIcon",class:h(e.class)},null,8,["class"])]),default:l(()=>[m(" "+p(a.$t("invoices.add_new_invoice")),1)]),_:1})]),key:"0"}:void 0]),1032,["title","description"]),[[D,N.value]]),V(f("div",Te,[f("div",$e,[t(ne,{class:"-mb-5",onChange:Y},{default:l(()=>[t(C,{title:a.$t("general.all"),filter:""},null,8,["title"]),t(C,{title:a.$t("general.draft"),filter:"DRAFT"},null,8,["title"]),t(C,{title:a.$t("general.sent"),filter:"SENT"},null,8,["title"]),t(C,{title:a.$t("general.due"),filter:"DUE"},null,8,["title"])]),_:1}),r(c).selectedInvoices.length&&r(E).hasAbilities(r(v).DELETE_INVOICE)?(b(),g(re,{key:0,class:"absolute float-right"},{activator:l(()=>[f("span",Ae,[m(p(a.$t("general.actions"))+" ",1),t(d,{name:"ChevronDownIcon"})])]),default:l(()=>[t(ie,{onClick:K},{default:l(()=>[t(d,{name:"TrashIcon",class:"mr-3 text-gray-600"}),m(" "+p(a.$t("general.delete")),1)]),_:1})]),_:1})):F("",!0)]),t(de,{ref_key:"table",ref:k,data:X,columns:H.value,"placeholder-count":r(c).invoiceTotalCount>=20?10:5,class:"mt-10"},j({header:l(()=>[f("div",Se,[t(x,{modelValue:r(c).selectAllField,"onUpdate:modelValue":i[7]||(i[7]=e=>r(c).selectAllField=e),variant:"primary",onChange:r(c).selectAllInvoices},null,8,["modelValue","onChange"])])]),"cell-checkbox":l(({row:e})=>[f("div",Pe,[t(x,{id:e.id,modelValue:w.value,"onUpdate:modelValue":i[8]||(i[8]=pe=>w.value=pe),value:e.data.id},null,8,["id","modelValue","value"])])]),"cell-name":l(({row:e})=>[t(ce,{text:e.data.customer.name,length:30},null,8,["text"])]),"cell-invoice_number":l(({row:e})=>[t(O,{to:{path:`invoices/${e.data.id}/view`},class:"font-medium text-primary-500"},{default:l(()=>[m(p(e.data.invoice_number),1)]),_:2},1032,["to"])]),"cell-invoice_date":l(({row:e})=>[m(p(e.data.formatted_invoice_date),1)]),"cell-total":l(({row:e})=>[t(L,{amount:e.data.total,currency:e.data.customer.currency},null,8,["amount","currency"])]),"cell-status":l(({row:e})=>[t(ue,{status:e.data.status,class:"px-3 py-1"},{default:l(()=>[m(p(e.data.status),1)]),_:2},1032,["status"])]),"cell-due_amount":l(({row:e})=>[f("div",Fe,[t(L,{amount:e.data.due_amount,currency:e.data.currency},null,8,["amount","currency"]),e.data.overdue?(b(),g(M,{key:0,status:"OVERDUE",class:"px-1 py-0.5 ml-2"},{default:l(()=>[m(p(a.$t("invoices.overdue")),1)]),_:1})):F("",!0),t(M,{status:e.data.paid_status,class:"px-1 py-0.5 ml-2"},{default:l(()=>[m(p(e.data.paid_status),1)]),_:2},1032,["status"])])]),_:2},[q()?{name:"cell-actions",fn:l(({row:e})=>[t(Ee,{row:e.data,table:k.value},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns","placeholder-count"])],512),[[D,!N.value]])]),_:1})}}};export{rt as default};
