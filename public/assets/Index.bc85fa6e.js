import{a as v,O as l,j as o,M as r,X as u,R as y,P as t,l as e,u as d,k as B,U as c,r as k,F as z,aW as W,by as X,g as J,as as S}from"./@vue.8cc12e6e.js";import{_ as K,r as Q,d as Y}from"./main.f5ac513d.js";import{d as Z,c as j,r as ee,m as te}from"./@vuelidate.c7422de1.js";import{v as P}from"./vue-i18n.c6de3223.js";import"./v-tooltip.1cd7a91e.js";import"./vue-resize.0b8cd4b5.js";import"./@popperjs.940d197a.js";import"./axios.7b768d2b.js";import"./vue-router.746ec05f.js";import"./pinia.32c02ade.js";import"./lodash.8ab3583e.js";import"./@intlify.0be1c2d8.js";import"./vue.a6ed3e81.js";import"./moment.9709ab41.js";import"./guid.7b3dea7e.js";import"./@headlessui.4523e0e1.js";import"./@vueuse.b6c5a1c1.js";import"./prettier.6e0a0647.js";import"./vue-flatpickr-component.30399bbe.js";import"./flatpickr.dff0933c.js";import"./@heroicons.aa650707.js";import"./v-money3.6f830de1.js";import"./maska.1121c2e3.js";const ae={key:0,class:"absolute mt-5 px-6 w-full flex justify-end"},se={key:0,class:"bg-white bg-opacity-75 text-xs px-3 py-1 font-semibold tracking-wide rounded"},oe={key:1,class:"ml-2 bg-white bg-opacity-75 text-xs px-3 py-1 font-semibold tracking-wide rounded"},ne={key:0},le={key:1},re=["src"],ie={class:"px-6 py-5 flex flex-col bg-gray-50 flex-1 justify-between"},de={class:"text-lg sm:text-2xl font-medium whitespace-nowrap truncate text-primary-500"},ce={key:0,class:"flex items-center mt-2"},ue=["src"],me=t("span",null,"by",-1),pe={class:"ml-2 text-base font-semibold truncate"},_e={class:"flex justify-between mt-4 flex-col space-y-2 sm:space-y-0 sm:flex-row"},he={class:"text-xl md:text-2xl font-semibold whitespace-nowrap text-primary-500"},fe={__name:"ModuleCard",props:{data:{type:Object,default:null,required:!0}},setup(s){const n=s;P.useI18n();let m=v(()=>parseInt(n.data.average_rating));return(i,p)=>{const _=l("base-text"),g=l("BaseRating");return o(),r("div",{class:"relative shadow-md border-2 border-gray-200 border-opacity-60 rounded-lg cursor-pointer overflow-hidden h-100",onClick:p[0]||(p[0]=w=>i.$router.push(`/admin/modules/${s.data.slug}`))},[s.data.purchased?(o(),r("div",ae,[s.data.purchased?(o(),r("label",se,u(i.$t("modules.purchased")),1)):y("",!0),s.data.installed?(o(),r("label",oe,[s.data.update_available?(o(),r("span",ne,u(i.$t("modules.update_available")),1)):(o(),r("span",le,u(i.$t("modules.installed")),1))])):y("",!0)])):y("",!0),t("img",{class:"lg:h-64 md:h-48 w-full object-cover object-center",src:s.data.cover,alt:"cover"},null,8,re),t("div",ie,[t("span",de,u(s.data.name),1),s.data.author_avatar?(o(),r("div",ce,[t("img",{class:"hidden h-10 w-10 rounded-full sm:inline-block mr-2",src:s.data.author_avatar?s.data.author_avatar:"http://localhost:3000/img/default-avatar.jpg",alt:""},null,8,ue),me,t("span",pe,u(s.data.author_name),1)])):y("",!0),e(_,{text:s.data.short_description,class:"pt-4 text-gray-500 h-16 line-clamp-2",length:110},null,8,["text"]),t("div",_e,[t("div",null,[e(g,{rating:d(m)},null,8,["rating"])]),t("div",he," $ "+u(s.data.monthly_price?s.data.monthly_price/100:s.data.yearly_price/100),1)])])])}}},ge={},ve={class:"shadow-md border-2 border-gray-200 border-opacity-60 rounded-lg cursor-pointer overflow-hidden h-100"},be={class:"px-6 py-5 flex flex-col bg-gray-50 flex-1 justify-between"},ye={class:"flex items-center mt-2"},xe={class:"flex justify-between mt-4 flex-col space-y-2 sm:space-y-0 sm:flex-row"};function ke(s,n){const m=l("BaseContentPlaceholdersBox"),i=l("BaseContentPlaceholdersText"),p=l("BaseContentPlaceholders");return o(),B(p,null,{default:c(()=>[t("div",ve,[e(m,{class:"h-48 lg:h-64 md:h-48 w-full",rounded:""}),t("div",be,[e(i,{class:"w-32 h-8",lines:1,rounded:""}),t("div",ye,[e(m,{class:"h-10 w-10 rounded-full sm:inline-block mr-2"}),t("div",null,[e(i,{class:"w-32 h-8 ml-2",lines:1,rounded:""})])]),e(i,{class:"pt-4 w-full h-16",lines:1,rounded:""}),t("div",xe,[e(i,{class:"w-32 h-8",lines:1,rounded:""}),e(i,{class:"w-32 h-8",lines:1,rounded:""})])])])]),_:1})}var $=K(ge,[["render",ke]]);const $e={key:0},Be={key:0,class:"grid mt-6 w-full grid-cols-1 items-start gap-6 lg:grid-cols-2 xl:grid-cols-3"},we={key:1},Te={key:0,class:"grid mt-6 w-full grid-cols-1 items-start gap-6 lg:grid-cols-2 xl:grid-cols-3"},Ie={key:1,class:"mt-24"},Ce={class:"flex items-center justify-center text-gray-500"},Se={class:"text-gray-900 text-lg font-medium"},je={class:"mt-1 text-sm text-gray-500"},Pe={class:"grid lg:grid-cols-2 mt-6"},Me=["onSubmit"],Ue={class:"flex space-x-2"},Ve=["href"],ot={__name:"Index",setup(s){const n=Q(),m=Y(),i=k(""),{t:p}=P.useI18n();let _=k(!1),g=k(!1);const w=v(()=>({api_token:{required:j.withMessage(p("validation.required"),ee),minLength:j.withMessage(p("validation.name_min_length",{count:3}),te(3))}})),M=v(()=>n.apiToken?(U(),!0):!1),h=Z(w,v(()=>n.currentUser)),x=v(()=>i.value==="INSTALLED"?n.modules.filter(a=>a.installed):n.modules);async function U(){g.value=!0,await n.fetchModules().then(()=>{g.value=!1})}async function V(){if(h.value.$touch(),h.value.$invalid)return!0;_.value=!0,n.checkApiToken(n.currentUser.api_token).then(a=>{if(a.data.success){G();return}_.value=!1})}async function G(){try{await m.updateGlobalSettings({data:{settings:{api_token:n.currentUser.api_token}},message:"settings.preferences.updated_message"}).then(a=>{if(a.data.success){n.apiToken=n.currentUser.api_token;return}}),_.value=!1}catch(a){_.value=!1,console.error(a);return}}function L(a){i.value=a.filter}return(a,b)=>{const T=l("BaseBreadcrumbItem"),A=l("BaseBreadcrumb"),N=l("BasePageHeader"),I=l("BaseTab"),q=l("BaseTabGroup"),D=l("BaseInput"),F=l("BaseInputGroup"),R=l("BaseIcon"),C=l("BaseButton"),E=l("BaseCard"),H=l("BasePage");return o(),B(H,null,{default:c(()=>[e(N,{title:a.$t("modules.title")},{default:c(()=>[e(A,null,{default:c(()=>[e(T,{title:a.$t("general.home"),to:"dashboard"},null,8,["title"]),e(T,{title:a.$tc("modules.module",2),to:"#",active:""},null,8,["title"])]),_:1})]),_:1},8,["title"]),M.value&&d(n).modules?(o(),r("div",$e,[e(q,{class:"-mb-5",onChange:L},{default:c(()=>[e(I,{title:a.$t("general.all"),filter:""},null,8,["title"]),e(I,{title:a.$t("modules.installed"),filter:"INSTALLED"},null,8,["title"])]),_:1}),d(g)?(o(),r("div",Be,[e($),e($),e($)])):(o(),r("div",we,[x.value&&x.value.length?(o(),r("div",Te,[(o(!0),r(z,null,W(x.value,(f,O)=>(o(),r("div",{key:O},[e(fe,{data:f},null,8,["data"])]))),128))])):(o(),r("div",Ie,[t("label",Ce,u(a.$t("modules.no_modules_installed")),1)]))]))])):(o(),B(E,{key:1,class:"mt-6"},{default:c(()=>[t("h6",Se,u(a.$t("modules.connect_installation")),1),t("p",je,u(a.$t("modules.api_token_description",{url:d(m).config.base_url.replace(/^http:\/\//,"")})),1),t("div",Pe,[t("form",{action:"",class:"mt-6",onSubmit:X(V,["prevent"])},[e(F,{label:a.$t("modules.api_token"),required:"",error:d(h).api_token.$error&&d(h).api_token.$errors[0].$message},{default:c(()=>[e(D,{modelValue:d(n).currentUser.api_token,"onUpdate:modelValue":b[0]||(b[0]=f=>d(n).currentUser.api_token=f),invalid:d(h).api_token.$error,onInput:b[1]||(b[1]=f=>d(h).api_token.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),t("div",Ue,[e(C,{class:"mt-6",loading:d(_),type:"submit"},{left:c(f=>[e(R,{name:"SaveIcon",class:J(f.class)},null,8,["class"])]),default:c(()=>[S(" "+u(a.$t("general.save")),1)]),_:1},8,["loading"]),t("a",{href:`${d(m).config.base_url}/auth/customer/register`,class:"mt-6 block",target:"_blank"},[e(C,{variant:"primary-outline",type:"button"},{default:c(()=>[S(" Sign up & Get Token ")]),_:1})],8,Ve)])],40,Me)])]),_:1}))]),_:1})}}};export{ot as default};
