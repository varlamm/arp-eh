import{k as R,c as z,u as P,j as V,e as O,g as E}from"./main.f5ac513d.js";import{v as U}from"./vue-i18n.c6de3223.js";import{u as H,b as J}from"./vue-router.746ec05f.js";import{i as W,O as I,j as i,k as l,U as r,u as n,l as m,as as c,X as d,R as g}from"./@vue.8cc12e6e.js";const K={__name:"EstimateIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null}},setup(o){const f=o,S=W("utils"),k=R(),_=z(),D=P(),w=V(),y=O(),{t:s}=U.useI18n(),v=H(),T=J();async function C(e){w.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_delete"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(t=>{e=e,t&&k.deleteEstimate({ids:[e]}).then(a=>{a&&(f.table&&f.table.refresh(),a.data&&T.push("/admin/estimates"),k.$patch(h=>{h.selectedEstimates=[],h.selectAllField=!1}))})})}function $(e){w.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_conversion"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(t=>{t&&k.convertToInvoice(e).then(a=>{a.data&&T.push(`/admin/invoices/${a.data.data.id}/edit`)})})}async function x(e){w.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_mark_as_sent"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(t=>{const a={id:e,status:"SENT"};t&&k.markAsSent(a).then(h=>{f.table&&f.table.refresh()})})}function N(e){return(e.status=="SENT"||e.status=="VIEWED")&&v.name!=="estimates.view"&&y.hasAbilities(E.SEND_ESTIMATE)}async function b(e){_.openModal({title:s("estimates.send_estimate"),componentName:"SendEstimateModal",id:e.id,data:e,variant:"lg"})}async function B(e){w.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_mark_as_accepted"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(t=>{const a={id:e,status:"ACCEPTED"};t&&k.markAsAccepted(a).then(h=>{f.table&&f.table.refresh()})})}async function M(e){w.openDialog({title:s("general.are_you_sure"),message:s("estimates.confirm_mark_as_rejected"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(t=>{const a={id:e,status:"REJECTED"};t&&k.markAsRejected(a).then(h=>{f.table&&f.table.refresh()})})}function L(){let e=`${window.location.origin}/estimates/pdf/${f.row.unique_hash}`;S.copyTextToClipboard(e),D.showNotification({type:"success",message:s("general.copied_pdf_url_clipboard")})}return(e,t)=>{const a=I("BaseIcon"),h=I("BaseButton"),u=I("BaseDropdownItem"),A=I("router-link"),j=I("BaseDropdown");return i(),l(j,null,{activator:r(()=>[n(v).name==="estimates.view"?(i(),l(h,{key:0,variant:"primary"},{default:r(()=>[m(a,{name:"DotsHorizontalIcon",class:"text-white"})]),_:1})):(i(),l(a,{key:1,class:"text-gray-500",name:"DotsHorizontalIcon"}))]),default:r(()=>[n(v).name==="estimates.view"?(i(),l(u,{key:0,onClick:L},{default:r(()=>[m(a,{name:"LinkIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("general.copy_pdf_url")),1)]),_:1})):g("",!0),n(y).hasAbilities(n(E).EDIT_ESTIMATE)?(i(),l(A,{key:1,to:`/admin/estimates/${o.row.id}/edit`},{default:r(()=>[m(u,null,{default:r(()=>[m(a,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("general.edit")),1)]),_:1})]),_:1},8,["to"])):g("",!0),n(y).hasAbilities(n(E).DELETE_ESTIMATE)?(i(),l(u,{key:2,onClick:t[0]||(t[0]=p=>C(o.row.id))},{default:r(()=>[m(a,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("general.delete")),1)]),_:1})):g("",!0),n(v).name!=="estimates.view"&&n(y).hasAbilities(n(E).VIEW_ESTIMATE)?(i(),l(A,{key:3,to:`estimates/${o.row.id}/view`},{default:r(()=>[m(u,null,{default:r(()=>[m(a,{name:"EyeIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("general.view")),1)]),_:1})]),_:1},8,["to"])):g("",!0),n(y).hasAbilities(n(E).CREATE_INVOICE)?(i(),l(u,{key:4,onClick:t[1]||(t[1]=p=>$(o.row.id))},{default:r(()=>[m(a,{name:"DocumentTextIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("estimates.convert_to_invoice")),1)]),_:1})):g("",!0),o.row.status!=="SENT"&&n(v).name!=="estimates.view"&&n(y).hasAbilities(n(E).SEND_ESTIMATE)?(i(),l(u,{key:5,onClick:t[2]||(t[2]=p=>x(o.row.id))},{default:r(()=>[m(a,{name:"CheckCircleIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("estimates.mark_as_sent")),1)]),_:1})):g("",!0),o.row.status!=="SENT"&&n(v).name!=="estimates.view"&&n(y).hasAbilities(n(E).SEND_ESTIMATE)?(i(),l(u,{key:6,onClick:t[3]||(t[3]=p=>b(o.row))},{default:r(()=>[m(a,{name:"PaperAirplaneIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("estimates.send_estimate")),1)]),_:1})):g("",!0),N(o.row)?(i(),l(u,{key:7,onClick:t[4]||(t[4]=p=>b(o.row))},{default:r(()=>[m(a,{name:"PaperAirplaneIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("estimates.resend_estimate")),1)]),_:1})):g("",!0),o.row.status!=="ACCEPTED"&&n(y).hasAbilities(n(E).EDIT_ESTIMATE)?(i(),l(u,{key:8,onClick:t[5]||(t[5]=p=>B(o.row.id))},{default:r(()=>[m(a,{name:"CheckCircleIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("estimates.mark_as_accepted")),1)]),_:1})):g("",!0),o.row.status!=="REJECTED"&&n(y).hasAbilities(n(E).EDIT_ESTIMATE)?(i(),l(u,{key:9,onClick:t[6]||(t[6]=p=>M(o.row.id))},{default:r(()=>[m(a,{name:"XCircleIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),c(" "+d(e.$t("estimates.mark_as_rejected")),1)]),_:1})):g("",!0)]),_:1})}}};export{K as _};
